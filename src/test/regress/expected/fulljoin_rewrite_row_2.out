create schema full_join_on_true_row_2;
set current_schema='full_join_on_true_row_2';
drop table if exists t1;
NOTICE:  table "t1" does not exist, skipping
drop table if exists t2;
NOTICE:  table "t2" does not exist, skipping
drop table if exists t3;
NOTICE:  table "t3" does not exist, skipping
create table t1(acct_id float, d int) ;
create table t2(acct_id float, d int) ;
create table t3(acct_id float, d int) ;
					 
insert into t1 values(1.1);
insert into t1 values(1.1);
insert into t1 values(121.1);
insert into t1 values(122.1);
insert into t1 values(122.1);
insert into t1 values(131.1);
insert into t1 values(132.1);
insert into t1 values(132.1);
insert into t1 values(888.1);
insert into t1 values(999.1);
insert into t1 values(999.1);
insert into t2 values(2.1);
insert into t2 values(2.1);
insert into t2 values(121.1);
insert into t2 values(122.1);
insert into t2 values(122.1);
insert into t2 values(231.1);
insert into t2 values(232.1);
insert into t2 values(232.1);
insert into t2 values(888.1);
insert into t2 values(999.1);
insert into t2 values(999.1);
insert into t3 values(3.1);
insert into t3 values(3.1);
insert into t3 values(231.1);
insert into t3 values(232.1);
insert into t3 values(232.1);
insert into t3 values(131.1);
insert into t3 values(132.1);
insert into t3 values(132.1);
insert into t3 values(888.1);
insert into t3 values(999.1);
insert into t3 values(999.1);
set enable_nestloop=on;
set enable_hashjoin=off;
set enable_mergejoin=off;	
				 
explain (verbose, costs off) select * from (select atan2(t1.acct_id,t2.acct_id)as acct_id from  t1 full outer join t2 on t1.acct_id=t2.acct_id ) A full join t3 on a.acct_id=t3.acct_id full join t1 on atan2(a.acct_id,t3.acct_id)=t1.acct_id order by 1,2,3,4;		
                                                                        QUERY PLAN                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Output: (atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id)), t3.acct_id, t3.d, full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
   Sort Key: (atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id)), t3.acct_id, t3.d, full_join_on_true_row_2.t1.acct_id
   ->  Hash Full Join
         Output: atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id), t3.acct_id, t3.d, full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
         Hash Cond: (atan2(atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id), t3.acct_id) = full_join_on_true_row_2.t1.acct_id)
         ->  Hash Full Join
               Output: full_join_on_true_row_2.t1.acct_id, t2.acct_id, t3.acct_id, t3.d
               Hash Cond: (atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id) = t3.acct_id)
               ->  Hash Full Join
                     Output: full_join_on_true_row_2.t1.acct_id, t2.acct_id
                     Hash Cond: (full_join_on_true_row_2.t1.acct_id = t2.acct_id)
                     ->  Seq Scan on full_join_on_true_row_2.t1
                           Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
                     ->  Hash
                           Output: t2.acct_id
                           ->  Seq Scan on full_join_on_true_row_2.t2
                                 Output: t2.acct_id
               ->  Hash
                     Output: t3.acct_id, t3.d
                     ->  Seq Scan on full_join_on_true_row_2.t3
                           Output: t3.acct_id, t3.d
         ->  Hash
               Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
               ->  Seq Scan on full_join_on_true_row_2.t1
                     Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
(26 rows)

select * from (select atan2(t1.acct_id,t2.acct_id)as acct_id from  t1 full outer join t2 on t1.acct_id=t2.acct_id ) A full join t3 on a.acct_id=t3.acct_id full join t1 on atan2(a.acct_id,t3.acct_id)=t1.acct_id order by 1,2,3,4;
     acct_id      | acct_id | d | acct_id | d 
------------------+---------+---+---------+---
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
                  |     3.1 |   |         |  
                  |     3.1 |   |         |  
                  |   131.1 |   |         |  
                  |   132.1 |   |         |  
                  |   132.1 |   |         |  
                  |   231.1 |   |         |  
                  |   232.1 |   |         |  
                  |   232.1 |   |         |  
                  |   888.1 |   |         |  
                  |   999.1 |   |         |  
                  |   999.1 |   |         |  
                  |         |   |     1.1 |  
                  |         |   |     1.1 |  
                  |         |   |   121.1 |  
                  |         |   |   122.1 |  
                  |         |   |   122.1 |  
                  |         |   |   131.1 |  
                  |         |   |   132.1 |  
                  |         |   |   132.1 |  
                  |         |   |   888.1 |  
                  |         |   |   999.1 |  
                  |         |   |   999.1 |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
(42 rows)

explain (verbose, costs off) select * from (select atan2(t1.acct_id,t2.acct_id)as acct_id from  t1 full outer join t2 on t1.acct_id=t2.acct_id ) A full join (select atan2(t3.acct_id,t2.acct_id)as acct_id from  t2 full outer join t3 on t3.acct_id=t2.acct_id )  t3 on a.acct_id=t3.acct_id full join t1 on atan2(a.acct_id,t3.acct_id)=t1.acct_id order by 1,2,3,4;
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Output: (atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id)), (atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id)), full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
   Sort Key: (atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id)), (atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id)), full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
   ->  Hash Full Join
         Output: atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id), atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id), full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
         Hash Cond: (atan2(atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id), atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id)) = full_join_on_true_row_2.t1.acct_id)
         ->  Hash Full Join
               Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t3.acct_id
               Hash Cond: (atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id) = atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id))
               ->  Hash Full Join
                     Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id
                     Hash Cond: (full_join_on_true_row_2.t1.acct_id = full_join_on_true_row_2.t2.acct_id)
                     ->  Seq Scan on full_join_on_true_row_2.t1
                           Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
                     ->  Hash
                           Output: full_join_on_true_row_2.t2.acct_id
                           ->  Seq Scan on full_join_on_true_row_2.t2
                                 Output: full_join_on_true_row_2.t2.acct_id
               ->  Hash
                     Output: full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t3.acct_id
                     ->  Hash Full Join
                           Output: full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t3.acct_id
                           Hash Cond: (full_join_on_true_row_2.t2.acct_id = full_join_on_true_row_2.t3.acct_id)
                           ->  Seq Scan on full_join_on_true_row_2.t2
                                 Output: full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t2.d
                           ->  Hash
                                 Output: full_join_on_true_row_2.t3.acct_id
                                 ->  Seq Scan on full_join_on_true_row_2.t3
                                       Output: full_join_on_true_row_2.t3.acct_id
         ->  Hash
               Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
               ->  Seq Scan on full_join_on_true_row_2.t1
                     Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
(33 rows)

select * from (select atan2(t1.acct_id,t2.acct_id)as acct_id from  t1 full outer join t2 on t1.acct_id=t2.acct_id ) A full join (select atan2(t3.acct_id,t2.acct_id)as acct_id from  t2 full outer join t3 on t3.acct_id=t2.acct_id )  t3 on a.acct_id=t3.acct_id full join t1 on atan2(a.acct_id,t3.acct_id)=t1.acct_id order by 1,2,3,4;
     acct_id      |     acct_id      | acct_id | d 
------------------+------------------+---------+---
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
                  |                  |     1.1 |  
                  |                  |     1.1 |  
                  |                  |   121.1 |  
                  |                  |   122.1 |  
                  |                  |   122.1 |  
                  |                  |   131.1 |  
                  |                  |   132.1 |  
                  |                  |   132.1 |  
                  |                  |   888.1 |  
                  |                  |   999.1 |  
                  |                  |   999.1 |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
(131 rows)

explain (costs off) select /*+  leading((t1 t2)) */ *from t1 full join t2 on t1.acct_id=t2.acct_id order by 1,2,3,4;
                   QUERY PLAN                   
------------------------------------------------
 Sort
   Sort Key: t1.acct_id, t1.d, t2.acct_id, t2.d
   ->  Hash Full Join
         Hash Cond: (t1.acct_id = t2.acct_id)
         ->  Seq Scan on t1
         ->  Hash
               ->  Seq Scan on t2
(7 rows)

select /*+  leading((t1 t2)) */ *from t1 full join t2 on t1.acct_id=t2.acct_id order by 1,2,3,4;
 acct_id | d | acct_id | d 
---------+---+---------+---
     1.1 |   |         |  
     1.1 |   |         |  
   121.1 |   |   121.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   131.1 |   |         |  
   132.1 |   |         |  
   132.1 |   |         |  
   888.1 |   |   888.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
         |   |     2.1 |  
         |   |     2.1 |  
         |   |   231.1 |  
         |   |   232.1 |  
         |   |   232.1 |  
(20 rows)

explain (costs off) select /*+  leading((t2 t1)) */ *from t1 full join t2 on t1.acct_id=t2.acct_id order by 1,2,3,4;
                   QUERY PLAN                   
------------------------------------------------
 Sort
   Sort Key: t1.acct_id, t1.d, t2.acct_id, t2.d
   ->  Hash Full Join
         Hash Cond: (t2.acct_id = t1.acct_id)
         ->  Seq Scan on t2
         ->  Hash
               ->  Seq Scan on t1
(7 rows)

select /*+  leading((t2 t1)) */ *from t1 full join t2 on t1.acct_id=t2.acct_id order by 1,2,3,4;
 acct_id | d | acct_id | d 
---------+---+---------+---
     1.1 |   |         |  
     1.1 |   |         |  
   121.1 |   |   121.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   131.1 |   |         |  
   132.1 |   |         |  
   132.1 |   |         |  
   888.1 |   |   888.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
         |   |     2.1 |  
         |   |     2.1 |  
         |   |   231.1 |  
         |   |   232.1 |  
         |   |   232.1 |  
(20 rows)

set enable_nestloop=off;
set enable_hashjoin=on;
set enable_mergejoin=off;
explain (verbose, costs off) select * from (select atan2(t1.acct_id,t2.acct_id)as acct_id from  t1 full outer join t2 on t1.acct_id=t2.acct_id ) A full join t3 on a.acct_id=t3.acct_id full join t1 on atan2(a.acct_id,t3.acct_id)=t1.acct_id order by 1,2,3,4;
                                                                        QUERY PLAN                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Output: (atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id)), t3.acct_id, t3.d, full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
   Sort Key: (atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id)), t3.acct_id, t3.d, full_join_on_true_row_2.t1.acct_id
   ->  Hash Full Join
         Output: atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id), t3.acct_id, t3.d, full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
         Hash Cond: (atan2(atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id), t3.acct_id) = full_join_on_true_row_2.t1.acct_id)
         ->  Hash Full Join
               Output: full_join_on_true_row_2.t1.acct_id, t2.acct_id, t3.acct_id, t3.d
               Hash Cond: (atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id) = t3.acct_id)
               ->  Hash Full Join
                     Output: full_join_on_true_row_2.t1.acct_id, t2.acct_id
                     Hash Cond: (full_join_on_true_row_2.t1.acct_id = t2.acct_id)
                     ->  Seq Scan on full_join_on_true_row_2.t1
                           Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
                     ->  Hash
                           Output: t2.acct_id
                           ->  Seq Scan on full_join_on_true_row_2.t2
                                 Output: t2.acct_id
               ->  Hash
                     Output: t3.acct_id, t3.d
                     ->  Seq Scan on full_join_on_true_row_2.t3
                           Output: t3.acct_id, t3.d
         ->  Hash
               Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
               ->  Seq Scan on full_join_on_true_row_2.t1
                     Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
(26 rows)

select * from (select atan2(t1.acct_id,t2.acct_id)as acct_id from  t1 full outer join t2 on t1.acct_id=t2.acct_id ) A full join t3 on a.acct_id=t3.acct_id full join t1 on atan2(a.acct_id,t3.acct_id)=t1.acct_id order by 1,2,3,4;
     acct_id      | acct_id | d | acct_id | d 
------------------+---------+---+---------+---
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
                  |     3.1 |   |         |  
                  |     3.1 |   |         |  
                  |   131.1 |   |         |  
                  |   132.1 |   |         |  
                  |   132.1 |   |         |  
                  |   231.1 |   |         |  
                  |   232.1 |   |         |  
                  |   232.1 |   |         |  
                  |   888.1 |   |         |  
                  |   999.1 |   |         |  
                  |   999.1 |   |         |  
                  |         |   |     1.1 |  
                  |         |   |     1.1 |  
                  |         |   |   121.1 |  
                  |         |   |   122.1 |  
                  |         |   |   122.1 |  
                  |         |   |   131.1 |  
                  |         |   |   132.1 |  
                  |         |   |   132.1 |  
                  |         |   |   888.1 |  
                  |         |   |   999.1 |  
                  |         |   |   999.1 |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
(42 rows)

explain (verbose, costs off) select * from (select atan2(t1.acct_id,t2.acct_id)as acct_id from  t1 full outer join t2 on t1.acct_id=t2.acct_id ) A full join (select atan2(t3.acct_id,t2.acct_id)as acct_id from  t2 full outer join t3 on t3.acct_id=t2.acct_id )  t3 on a.acct_id=t3.acct_id full join t1 on atan2(a.acct_id,t3.acct_id)=t1.acct_id order by 1,2,3,4;
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Output: (atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id)), (atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id)), full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
   Sort Key: (atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id)), (atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id)), full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
   ->  Hash Full Join
         Output: atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id), atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id), full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
         Hash Cond: (atan2(atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id), atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id)) = full_join_on_true_row_2.t1.acct_id)
         ->  Hash Full Join
               Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t3.acct_id
               Hash Cond: (atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id) = atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id))
               ->  Hash Full Join
                     Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id
                     Hash Cond: (full_join_on_true_row_2.t1.acct_id = full_join_on_true_row_2.t2.acct_id)
                     ->  Seq Scan on full_join_on_true_row_2.t1
                           Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
                     ->  Hash
                           Output: full_join_on_true_row_2.t2.acct_id
                           ->  Seq Scan on full_join_on_true_row_2.t2
                                 Output: full_join_on_true_row_2.t2.acct_id
               ->  Hash
                     Output: full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t3.acct_id
                     ->  Hash Full Join
                           Output: full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t3.acct_id
                           Hash Cond: (full_join_on_true_row_2.t2.acct_id = full_join_on_true_row_2.t3.acct_id)
                           ->  Seq Scan on full_join_on_true_row_2.t2
                                 Output: full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t2.d
                           ->  Hash
                                 Output: full_join_on_true_row_2.t3.acct_id
                                 ->  Seq Scan on full_join_on_true_row_2.t3
                                       Output: full_join_on_true_row_2.t3.acct_id
         ->  Hash
               Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
               ->  Seq Scan on full_join_on_true_row_2.t1
                     Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
(33 rows)

select * from (select atan2(t1.acct_id,t2.acct_id)as acct_id from  t1 full outer join t2 on t1.acct_id=t2.acct_id ) A full join (select atan2(t3.acct_id,t2.acct_id)as acct_id from  t2 full outer join t3 on t3.acct_id=t2.acct_id )  t3 on a.acct_id=t3.acct_id full join t1 on atan2(a.acct_id,t3.acct_id)=t1.acct_id order by 1,2,3,4;
     acct_id      |     acct_id      | acct_id | d 
------------------+------------------+---------+---
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
                  |                  |     1.1 |  
                  |                  |     1.1 |  
                  |                  |   121.1 |  
                  |                  |   122.1 |  
                  |                  |   122.1 |  
                  |                  |   131.1 |  
                  |                  |   132.1 |  
                  |                  |   132.1 |  
                  |                  |   888.1 |  
                  |                  |   999.1 |  
                  |                  |   999.1 |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
(131 rows)

explain (costs off) select /*+  leading((t1 t2)) */ *from t1 full join t2 on t1.acct_id=t2.acct_id order by 1,2,3,4;
                   QUERY PLAN                   
------------------------------------------------
 Sort
   Sort Key: t1.acct_id, t1.d, t2.acct_id, t2.d
   ->  Hash Full Join
         Hash Cond: (t1.acct_id = t2.acct_id)
         ->  Seq Scan on t1
         ->  Hash
               ->  Seq Scan on t2
(7 rows)

select /*+  leading((t1 t2)) */ *from t1 full join t2 on t1.acct_id=t2.acct_id order by 1,2,3,4;
 acct_id | d | acct_id | d 
---------+---+---------+---
     1.1 |   |         |  
     1.1 |   |         |  
   121.1 |   |   121.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   131.1 |   |         |  
   132.1 |   |         |  
   132.1 |   |         |  
   888.1 |   |   888.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
         |   |     2.1 |  
         |   |     2.1 |  
         |   |   231.1 |  
         |   |   232.1 |  
         |   |   232.1 |  
(20 rows)

explain (costs off) select /*+  leading((t2 t1)) */ *from t1 full join t2 on t1.acct_id=t2.acct_id order by 1,2,3,4;
                   QUERY PLAN                   
------------------------------------------------
 Sort
   Sort Key: t1.acct_id, t1.d, t2.acct_id, t2.d
   ->  Hash Full Join
         Hash Cond: (t2.acct_id = t1.acct_id)
         ->  Seq Scan on t2
         ->  Hash
               ->  Seq Scan on t1
(7 rows)

select /*+  leading((t2 t1)) */ *from t1 full join t2 on t1.acct_id=t2.acct_id order by 1,2,3,4;
 acct_id | d | acct_id | d 
---------+---+---------+---
     1.1 |   |         |  
     1.1 |   |         |  
   121.1 |   |   121.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   131.1 |   |         |  
   132.1 |   |         |  
   132.1 |   |         |  
   888.1 |   |   888.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
         |   |     2.1 |  
         |   |     2.1 |  
         |   |   231.1 |  
         |   |   232.1 |  
         |   |   232.1 |  
(20 rows)

set enable_nestloop=off;
set enable_hashjoin=off;
set enable_mergejoin=on;
					 
explain (verbose, costs off) select * from (select atan2(t1.acct_id,t2.acct_id)as acct_id from  t1 full outer join t2 on t1.acct_id=t2.acct_id ) A full join t3 on a.acct_id=t3.acct_id full join t1 on atan2(a.acct_id,t3.acct_id)=t1.acct_id order by 1,2,3,4;
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Output: (atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id)), t3.acct_id, t3.d, full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
   Sort Key: (atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id)), t3.acct_id, t3.d, full_join_on_true_row_2.t1.acct_id
   ->  Merge Full Join
         Output: atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id), t3.acct_id, t3.d, full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
         Merge Cond: (full_join_on_true_row_2.t1.acct_id = atan2(atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id), t3.acct_id))
         ->  Sort
               Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
               Sort Key: full_join_on_true_row_2.t1.acct_id
               ->  Seq Scan on full_join_on_true_row_2.t1
                     Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
         ->  Materialize
               Output: full_join_on_true_row_2.t1.acct_id, t2.acct_id, t3.acct_id, t3.d, (atan2(atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id), t3.acct_id))
               ->  Sort
                     Output: full_join_on_true_row_2.t1.acct_id, t2.acct_id, t3.acct_id, t3.d, (atan2(atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id), t3.acct_id))
                     Sort Key: (atan2(atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id), t3.acct_id))
                     ->  Merge Full Join
                           Output: full_join_on_true_row_2.t1.acct_id, t2.acct_id, t3.acct_id, t3.d, atan2(atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id), t3.acct_id)
                           Merge Cond: (t3.acct_id = atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id))
                           ->  Sort
                                 Output: t3.acct_id, t3.d
                                 Sort Key: t3.acct_id
                                 ->  Seq Scan on full_join_on_true_row_2.t3
                                       Output: t3.acct_id, t3.d
                           ->  Sort
                                 Output: full_join_on_true_row_2.t1.acct_id, t2.acct_id, (atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id))
                                 Sort Key: (atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id))
                                 ->  Merge Full Join
                                       Output: full_join_on_true_row_2.t1.acct_id, t2.acct_id, atan2(full_join_on_true_row_2.t1.acct_id, t2.acct_id)
                                       Merge Cond: (full_join_on_true_row_2.t1.acct_id = t2.acct_id)
                                       ->  Sort
                                             Output: full_join_on_true_row_2.t1.acct_id
                                             Sort Key: full_join_on_true_row_2.t1.acct_id
                                             ->  Seq Scan on full_join_on_true_row_2.t1
                                                   Output: full_join_on_true_row_2.t1.acct_id
                                       ->  Sort
                                             Output: t2.acct_id
                                             Sort Key: t2.acct_id
                                             ->  Seq Scan on full_join_on_true_row_2.t2
                                                   Output: t2.acct_id
(40 rows)

select * from (select atan2(t1.acct_id,t2.acct_id)as acct_id from  t1 full outer join t2 on t1.acct_id=t2.acct_id ) A full join t3 on a.acct_id=t3.acct_id full join t1 on atan2(a.acct_id,t3.acct_id)=t1.acct_id order by 1,2,3,4;
     acct_id      | acct_id | d | acct_id | d 
------------------+---------+---+---------+---
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
 .785398163397448 |         |   |         |  
                  |     3.1 |   |         |  
                  |     3.1 |   |         |  
                  |   131.1 |   |         |  
                  |   132.1 |   |         |  
                  |   132.1 |   |         |  
                  |   231.1 |   |         |  
                  |   232.1 |   |         |  
                  |   232.1 |   |         |  
                  |   888.1 |   |         |  
                  |   999.1 |   |         |  
                  |   999.1 |   |         |  
                  |         |   |     1.1 |  
                  |         |   |     1.1 |  
                  |         |   |   121.1 |  
                  |         |   |   122.1 |  
                  |         |   |   122.1 |  
                  |         |   |   131.1 |  
                  |         |   |   132.1 |  
                  |         |   |   132.1 |  
                  |         |   |   888.1 |  
                  |         |   |   999.1 |  
                  |         |   |   999.1 |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
                  |         |   |         |  
(42 rows)

explain (verbose, costs off) select * from (select atan2(t1.acct_id,t2.acct_id)as acct_id from  t1 full outer join t2 on t1.acct_id=t2.acct_id ) A full join (select atan2(t3.acct_id,t2.acct_id)as acct_id from  t2 full outer join t3 on t3.acct_id=t2.acct_id )  t3 on a.acct_id=t3.acct_id full join t1 on atan2(a.acct_id,t3.acct_id)=t1.acct_id order by 1,2,3,4;
                                                                                                                                                                      QUERY PLAN                                                                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Output: (atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id)), (atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id)), full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
   Sort Key: (atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id)), (atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id)), full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
   ->  Merge Full Join
         Output: atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id), atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id), full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
         Merge Cond: (full_join_on_true_row_2.t1.acct_id = atan2(atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id), atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id)))
         ->  Sort
               Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
               Sort Key: full_join_on_true_row_2.t1.acct_id
               ->  Seq Scan on full_join_on_true_row_2.t1
                     Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t1.d
         ->  Materialize
               Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t3.acct_id, (atan2(atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id), atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id)))
               ->  Sort
                     Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t3.acct_id, (atan2(atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id), atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id)))
                     Sort Key: (atan2(atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id), atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id)))
                     ->  Merge Full Join
                           Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t3.acct_id, atan2(atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id), atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id))
                           Merge Cond: (atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id) = atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id))
                           ->  Sort
                                 Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id, (atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id))
                                 Sort Key: (atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id))
                                 ->  Merge Full Join
                                       Output: full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id, atan2(full_join_on_true_row_2.t1.acct_id, full_join_on_true_row_2.t2.acct_id)
                                       Merge Cond: (full_join_on_true_row_2.t1.acct_id = full_join_on_true_row_2.t2.acct_id)
                                       ->  Sort
                                             Output: full_join_on_true_row_2.t1.acct_id
                                             Sort Key: full_join_on_true_row_2.t1.acct_id
                                             ->  Seq Scan on full_join_on_true_row_2.t1
                                                   Output: full_join_on_true_row_2.t1.acct_id
                                       ->  Sort
                                             Output: full_join_on_true_row_2.t2.acct_id
                                             Sort Key: full_join_on_true_row_2.t2.acct_id
                                             ->  Seq Scan on full_join_on_true_row_2.t2
                                                   Output: full_join_on_true_row_2.t2.acct_id
                           ->  Sort
                                 Output: full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t3.acct_id, (atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id))
                                 Sort Key: (atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id))
                                 ->  Merge Full Join
                                       Output: full_join_on_true_row_2.t2.acct_id, full_join_on_true_row_2.t3.acct_id, atan2(full_join_on_true_row_2.t3.acct_id, full_join_on_true_row_2.t2.acct_id)
                                       Merge Cond: (full_join_on_true_row_2.t2.acct_id = full_join_on_true_row_2.t3.acct_id)
                                       ->  Sort
                                             Output: full_join_on_true_row_2.t2.acct_id
                                             Sort Key: full_join_on_true_row_2.t2.acct_id
                                             ->  Seq Scan on full_join_on_true_row_2.t2
                                                   Output: full_join_on_true_row_2.t2.acct_id
                                       ->  Sort
                                             Output: full_join_on_true_row_2.t3.acct_id
                                             Sort Key: full_join_on_true_row_2.t3.acct_id
                                             ->  Seq Scan on full_join_on_true_row_2.t3
                                                   Output: full_join_on_true_row_2.t3.acct_id
(51 rows)

select * from (select atan2(t1.acct_id,t2.acct_id)as acct_id from  t1 full outer join t2 on t1.acct_id=t2.acct_id ) A full join (select atan2(t3.acct_id,t2.acct_id)as acct_id from  t2 full outer join t3 on t3.acct_id=t2.acct_id )  t3 on a.acct_id=t3.acct_id full join t1 on atan2(a.acct_id,t3.acct_id)=t1.acct_id order by 1,2,3,4;
     acct_id      |     acct_id      | acct_id | d 
------------------+------------------+---------+---
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
 .785398163397448 | .785398163397448 |         |  
                  |                  |     1.1 |  
                  |                  |     1.1 |  
                  |                  |   121.1 |  
                  |                  |   122.1 |  
                  |                  |   122.1 |  
                  |                  |   131.1 |  
                  |                  |   132.1 |  
                  |                  |   132.1 |  
                  |                  |   888.1 |  
                  |                  |   999.1 |  
                  |                  |   999.1 |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
                  |                  |         |  
(131 rows)

explain (costs off) select /*+  leading((t1 t2)) */ *from t1 full join t2 on t1.acct_id=t2.acct_id order by 1,2,3,4;
                   QUERY PLAN                   
------------------------------------------------
 Sort
   Sort Key: t1.acct_id, t1.d, t2.acct_id, t2.d
   ->  Merge Full Join
         Merge Cond: (t1.acct_id = t2.acct_id)
         ->  Sort
               Sort Key: t1.acct_id
               ->  Seq Scan on t1
         ->  Sort
               Sort Key: t2.acct_id
               ->  Seq Scan on t2
(10 rows)

select /*+  leading((t1 t2)) */ *from t1 full join t2 on t1.acct_id=t2.acct_id order by 1,2,3,4;
 acct_id | d | acct_id | d 
---------+---+---------+---
     1.1 |   |         |  
     1.1 |   |         |  
   121.1 |   |   121.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   131.1 |   |         |  
   132.1 |   |         |  
   132.1 |   |         |  
   888.1 |   |   888.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
         |   |     2.1 |  
         |   |     2.1 |  
         |   |   231.1 |  
         |   |   232.1 |  
         |   |   232.1 |  
(20 rows)

explain (costs off) select /*+  leading((t2 t1)) */ *from t1 full join t2 on t1.acct_id=t2.acct_id order by 1,2,3,4;
                   QUERY PLAN                   
------------------------------------------------
 Sort
   Sort Key: t1.acct_id, t1.d, t2.acct_id, t2.d
   ->  Merge Full Join
         Merge Cond: (t2.acct_id = t1.acct_id)
         ->  Sort
               Sort Key: t2.acct_id
               ->  Seq Scan on t2
         ->  Sort
               Sort Key: t1.acct_id
               ->  Seq Scan on t1
(10 rows)

select /*+  leading((t2 t1)) */ *from t1 full join t2 on t1.acct_id=t2.acct_id order by 1,2,3,4;
 acct_id | d | acct_id | d 
---------+---+---------+---
     1.1 |   |         |  
     1.1 |   |         |  
   121.1 |   |   121.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   122.1 |   |   122.1 |  
   131.1 |   |         |  
   132.1 |   |         |  
   132.1 |   |         |  
   888.1 |   |   888.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
   999.1 |   |   999.1 |  
         |   |     2.1 |  
         |   |     2.1 |  
         |   |   231.1 |  
         |   |   232.1 |  
         |   |   232.1 |  
(20 rows)

drop schema full_join_on_true_row_2 CASCADE;
NOTICE:  drop cascades to 3 other objects
DETAIL:  drop cascades to table t1
drop cascades to table t2
drop cascades to table t3

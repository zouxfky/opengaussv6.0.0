drop table if exists tab;
NOTICE:  table "tab" does not exist, skipping
create table tab (col SET('a','b')); -- failed
ERROR:  set type is not yet supported.
LINE 1: create table tab (col SET('a','b'));
                              ^
create table tab (col int);
alter table tab modify col SET('a','b');
ERROR:  set type is not yet supported.
LINE 1: alter table tab modify col SET('a','b');
                                   ^
select find_in_set('a', 'a,b');
ERROR:  cannot accept a value of type anyset
LINE 1: select find_in_set('a', 'a,b');
                                ^
CONTEXT:  referenced column: find_in_set
select find_in_set('a', 1);
ERROR:  invalid input value for set anyset: 1
CONTEXT:  referenced column: find_in_set
create database test dbcompatibility = 'B';
\c test
SET b_format_behavior_compat_options = 'enable_multi_charset';
drop table if exists tab;
NOTICE:  table "tab" does not exist, skipping
drop table if exists dual;
NOTICE:  table "dual" does not exist, skipping
create table dual (dummy varchar(1));
insert into dual values ('X');
-- check the table's privilage
select relname, relacl[1]::text ~ '=r/*' as haspriv from pg_class where relname='pg_set'; -- expect true
 relname | haspriv 
---------+---------
 pg_set  | t
(1 row)

-- _anyset not supported
select count(*) from pg_type where typname = '_anyset'; -- expected 0
 count 
-------
     0
(1 row)

-- create table with invalid SET type
-- number of values 1 <= n <= 64;
create table tab (col SET());
ERROR:  It's not supported to create empty set column
LINE 1: create table tab (col SET());
                              ^
create table tab (col SET('1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65'));
NOTICE:  CREATE TABLE will create implicit set "tab_col_set" for column "tab.col"
ERROR:  Too many strings for SET column
DETAIL:  SET must contain 1 to 64 strings.
create table tab (col SET('1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64'));
NOTICE:  CREATE TABLE will create implicit set "tab_col_set" for column "tab.col"
drop table tab;
-- set values length <= 255 char
create table tab (col SET('dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd'));
NOTICE:  CREATE TABLE will create implicit set "tab_col_set" for column "tab.col"
ERROR:  Too long set value for column
DETAIL:  Set value must contain 0 to 255 characters.
create table tab (col SET('大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大'));
NOTICE:  CREATE TABLE will create implicit set "tab_col_set" for column "tab.col"
ERROR:  Too long set value for column
DETAIL:  Set value must contain 0 to 255 characters.
create table tab (col SET('dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd,dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd'));
NOTICE:  CREATE TABLE will create implicit set "tab_col_set" for column "tab.col"
ERROR:  Illegal set 'dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd,dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd' found during parsing
DETAIL:  Set value must not contain ','
create table tab (col SET('大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大大'));
NOTICE:  CREATE TABLE will create implicit set "tab_col_set" for column "tab.col"
drop table tab;
-- set values contails ','
create table tab (col SET('a,b'));
NOTICE:  CREATE TABLE will create implicit set "tab_col_set" for column "tab.col"
ERROR:  Illegal set 'a,b' found during parsing
DETAIL:  Set value must not contain ','
create table tab (col SET('a,b', 'c'));
NOTICE:  CREATE TABLE will create implicit set "tab_col_set" for column "tab.col"
ERROR:  Illegal set 'a,b' found during parsing
DETAIL:  Set value must not contain ','
-- has same set value
create table tab (col SET('a','b','c','a'));  -- unstable testcase
NOTICE:  CREATE TABLE will create implicit set "tab_col_set" for column "tab.col"
ERROR:  duplicate key value violates unique constraint "pg_set_typid_label_index"
--?.*
-- set array not support
create table tab (col SET('a', 'b')[]);
ERROR:  array of set is not implemented
LINE 1: create table tab (col SET('a', 'b')[]);
                              ^
-- set value is not const string
create table tab (col set(1,2,3));
ERROR:  syntax error at or near "1"
LINE 1: create table tab (col set(1,2,3));
                                  ^
create table tab (col set('a'||'b', 'c'));
ERROR:  syntax error at or near "||"
LINE 1: create table tab (col set('a'||'b', 'c'));
                                     ^
-- set domain not support
create table tab (col set('a', 'b'));
NOTICE:  CREATE TABLE will create implicit set "tab_col_set" for column "tab.col"
create domain abc as tab_col_set (value > 10);
ERROR:  type modifier is not allowed for type "tab_col_set"
-- use exists set type
drop table if exists t1;
NOTICE:  table "t1" does not exist, skipping
create table t1 (c1 tab_col_set);
ERROR:  can not use existed set type tab_col_set for column definition
LINE 1: create table t1 (c1 tab_col_set);
                            ^
create table t1 (c1 set('a', 'b'), c2 t1_c1_set);
NOTICE:  CREATE TABLE will create implicit set "t1_c1_set" for column "t1.c1"
ERROR:  type "t1_c1_set" does not exist
LINE 1: create table t1 (c1 set('a', 'b'), c2 t1_c1_set);
                                              ^
-- create table use select
create table t1 as select * from tab;
ERROR:  can not use existed set type tab_col_set for column definition
LINE 1: create table t1 as select * from tab;
        ^
create table t1 (like tab);
ERROR:  can not use existed set type tab_col_set for column definition
LINE 1: create table t1 (like tab);
                              ^
-- can not use set column as partition key
create table test_set_tab(c1 set('a', 'b', 'c', 'd'), c2 int) partition by range(c1)
(
	partition test_set_tab_p1 values less than (1),
	partition test_set_tab_p2 values less than (7)
);
NOTICE:  CREATE TABLE will create implicit set "test_set_tab_c1_set" for column "test_set_tab.c1"
ERROR:  column c1 cannot serve as a range partitioning column because of its datatype
create table test_set_tab(c1 set('a', 'b', 'c', 'd'), c2 int) partition by hash(c1)
(
	partition test_set_tab_p1,
	partition test_set_tab_p2
);
NOTICE:  CREATE TABLE will create implicit set "test_set_tab_c1_set" for column "test_set_tab.c1"
ERROR:  column c1 cannot serve as a hash partitioning column because of its datatype
-- cstore not support with set type
create table test_set_tab(c1 set('a', 'b', 'c', 'd'), c2 int) with (ORIENTATION = column); -- failed
NOTICE:  CREATE TABLE will create implicit set "test_set_tab_c1_set" for column "test_set_tab.c1"
ERROR:  type "test_set_tab_c1_set" is not supported in column store
create table test_set_tab(c1 set('a', 'b', 'c', 'd'), c2 int) with (STORAGE_TYPE = ustore); -- succeed
NOTICE:  CREATE TABLE will create implicit set "test_set_tab_c1_set" for column "test_set_tab.c1"
insert into test_set_tab values (1, 1), (2,2), ('a,b',3), ('c', 4), ('d', 8);
-- local/global temp table set column test
create local temp table temp_set_tab (c1 set('a', 'b'));
NOTICE:  CREATE TABLE will create implicit set "temp_set_tab_c1_set" for column "temp_set_tab.c1"
create global temp table temp_set_tab (c1 set('a', 'b'));
NOTICE:  CREATE TABLE will create implicit set "temp_set_tab_c1_set" for column "temp_set_tab.c1"
select count(1) from pg_type where typname='temp_set_tab_c1_set'; -- expect 2
 count 
-------
     2
(1 row)

drop table temp_set_tab; -- temp namespace
drop table temp_set_tab; -- public namespace
select count(1) from pg_type where typname='temp_set_tab_c1_set'; -- expect 0
 count 
-------
     0
(1 row)

-- trim right space for set labels
drop table if exists trim_test_tab;
NOTICE:  table "trim_test_tab" does not exist, skipping
create table trim_test_tab(c1 set('   ', 'a    ', ' b  ', '  c')); -- set('', 'a', ' b', '  c')
NOTICE:  CREATE TABLE will create implicit set "trim_test_tab_c1_set" for column "trim_test_tab.c1"
insert into trim_test_tab values ('   '); -- failed
ERROR:  invalid input value for set trim_test_tab_c1_set: '   '
LINE 1: insert into trim_test_tab values ('   ');
                                          ^
CONTEXT:  referenced column: c1
insert into trim_test_tab values ('a    '); -- failed
ERROR:  invalid input value for set trim_test_tab_c1_set: 'a    '
LINE 1: insert into trim_test_tab values ('a    ');
                                          ^
CONTEXT:  referenced column: c1
insert into trim_test_tab values (' b  '); -- failed
ERROR:  invalid input value for set trim_test_tab_c1_set: ' b  '
LINE 1: insert into trim_test_tab values (' b  ');
                                          ^
CONTEXT:  referenced column: c1
insert into trim_test_tab values ('  c'); -- success
insert into trim_test_tab values (', b,a'); -- success
\dT+ trim_test_tab_c1_set;
                                            List of data types
 Schema |         Name         |    Internal name     | Size | Elements | Access privileges | Description 
--------+----------------------+----------------------+------+----------+-------------------+-------------
 public | trim_test_tab_c1_set | trim_test_tab_c1_set | var  |         +|                   | 
        |                      |                      |      | a       +|                   | 
        |                      |                      |      |  b      +|                   | 
        |                      |                      |      |   c      |                   | 
(1 row)

-- trime the bpchar right space when cast to set labal
alter table trim_test_tab modify c1 char(10);
insert into trim_test_tab values ('a   ');
insert into trim_test_tab values ('a');
insert into trim_test_tab values ('a   b');
alter table trim_test_tab modify c1 set('', 'a', ' b', '  c', 'a   b');
NOTICE:  ALTER TABLE will create implicit set "trim_test_tab_c1_set" for column "trim_test_tab.c1"
drop table trim_test_tab;
-- alter table test
-- add
alter table test_set_tab add c3 set();
ERROR:  It's not supported to create empty set column
LINE 1: alter table test_set_tab add c3 set();
                                        ^
alter table test_set_tab add c3 set('1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65');
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c3_set" for column "test_set_tab.c3"
ERROR:  Too many strings for SET column
DETAIL:  SET must contain 1 to 64 strings.
alter table test_set_tab add c3 set('a,b');
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c3_set" for column "test_set_tab.c3"
ERROR:  Illegal set 'a,b' found during parsing
DETAIL:  Set value must not contain ','
alter table test_set_tab add c3 set('dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd');
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c3_set" for column "test_set_tab.c3"
ERROR:  Too long set value for column
DETAIL:  Set value must contain 0 to 255 characters.
-- alter table test_set_tab add c3 set('a','b','c','a'); -- unstable testcase
alter table test_set_tab add c3 set('a','b','c')[];
ERROR:  array of set is not implemented
LINE 1: alter table test_set_tab add c3 set('a','b','c')[];
                                        ^
alter table test_set_tab add c3 set(1, 2, 3);
ERROR:  syntax error at or near "1"
LINE 1: alter table test_set_tab add c3 set(1, 2, 3);
                                            ^
alter table test_set_tab add c3 test_set_tab_c1_set;
ERROR:  can not use existed set type test_set_tab_c1_set for column definition
LINE 1: alter table test_set_tab add c3 test_set_tab_c1_set;
                                        ^
drop type if exists test_set_tab_c3_set;
NOTICE:  type "test_set_tab_c3_set" does not exist, skipping
create type test_set_tab_c3_set as ENUM ('a', 'b');
alter table test_set_tab add c3 set('a', 'b'); -- failed
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c3_set" for column "test_set_tab.c3"
ERROR:  type "test_set_tab_c3_set" already exists
drop type test_set_tab_c3_set;
alter table test_set_tab add c3 set ('a', 'b', 'c'); -- succeed
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c3_set" for column "test_set_tab.c3"
-- modify non-set to set type failed when the set type is invalid defined.
alter table test_set_tab modify c2 set();
ERROR:  It's not supported to create empty set column
LINE 1: alter table test_set_tab modify c2 set();
                                           ^
alter table test_set_tab modify c2 set('1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65');
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c2_set" for column "test_set_tab.c2"
ERROR:  Too many strings for SET column
DETAIL:  SET must contain 1 to 64 strings.
alter table test_set_tab modify c2 set('a,b');
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c2_set" for column "test_set_tab.c2"
ERROR:  Illegal set 'a,b' found during parsing
DETAIL:  Set value must not contain ','
alter table test_set_tab modify c2 set('dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd');
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c2_set" for column "test_set_tab.c2"
ERROR:  Too long set value for column
DETAIL:  Set value must contain 0 to 255 characters.
-- alter table test_set_tab modify c2 set('a','b','c','a'); -- unstable testcase
alter table test_set_tab modify c2 set('a','b','c')[];
ERROR:  array of set is not implemented
LINE 1: alter table test_set_tab modify c2 set('a','b','c')[];
                                           ^
alter table test_set_tab modify c2 test_set_tab_c1_set;
ERROR:  can not use existed set type test_set_tab_c1_set for column definition
drop type if exists test_set_tab_c2_set;
NOTICE:  type "test_set_tab_c2_set" does not exist, skipping
create type test_set_tab_c2_set as ENUM ('a', 'b');
alter table test_set_tab modify c2 set('a', 'b');  --failed
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c2_set" for column "test_set_tab.c2"
ERROR:  type modifier is not allowed for type "public.test_set_tab_c2_set"
LINE 1: alter table test_set_tab modify c2 set('a', 'b');
                                           ^
drop type test_set_tab_c2_set;
-- out of range, here we can test more datatypes such as float, text, varchar, etc..
alter table test_set_tab modify c2 set('a', 'b', 'c'); -- failed, 8 out of range
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c2_set" for column "test_set_tab.c2"
ERROR:  invalid input value for set test_set_tab_c2_set: 8
update test_set_tab set c2 = 7 where c2 = 8;
alter table test_set_tab modify c2 set('a', 'b', 'c'); -- succeed
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c2_set" for column "test_set_tab.c2"
alter table test_set_tab add c4 float8;
update test_set_tab set c4=479674615.454654;
alter table test_set_tab modify c4 set('a', 'b', 'c'); -- failed
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c4_set" for column "test_set_tab.c4"
ERROR:  invalid input value for set test_set_tab_c4_set: 479674615
update test_set_tab set c4=5.454654;
alter table test_set_tab modify c4 set('a', 'b', 'c'); -- succeed
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c4_set" for column "test_set_tab.c4"
-- datatype can not convert to set
alter table test_set_tab add c5 date;
update test_set_tab set c5 = to_date('2022-04-13');
alter table test_set_tab modify c5 set('a', 'b', 'c'); -- failed, no convert path for date to set
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c5_set" for column "test_set_tab.c5"
ERROR:  column "c5" cannot be cast automatically to type test_set_tab_c5_set
HINT:  Specify a USING expression to perform the conversion.
alter table test_set_tab modify c5 text;
alter table test_set_tab modify c5 set('a', 'b', 'c'); -- failed, invalid set value
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c5_set" for column "test_set_tab.c5"
ERROR:  invalid input value for set test_set_tab_c5_set: '04-13-2022'
alter table test_set_tab modify c5 set('2022-04-13 00:00:00'); -- succeed
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_c5_set" for column "test_set_tab.c5"
ERROR:  invalid input value for set test_set_tab_c5_set: '04-13-2022'
-- can not modify partition key col to set
create table test_set_tab_part(c1 set('a', 'b', 'c', 'd'), c2 int) partition by range(c2)
(
	partition test_set_tab_p1 values less than (1),
	partition test_set_tab_p2 values less than (7)
);
NOTICE:  CREATE TABLE will create implicit set "test_set_tab_part_c1_set" for column "test_set_tab_part.c1"
alter table test_set_tab_part modify c2 set('a', 'b', 'c');
NOTICE:  ALTER TABLE will create implicit set "test_set_tab_part_c2_set" for column "test_set_tab_part.c2"
ERROR:  cannot alter data type of partitioning column "c2"
select count(1) from pg_type where typname='test_set_tab_part_c2_set'; -- expect 0
 count 
-------
     0
(1 row)

-- alter table owner test
reset role;
create user rsr_test01 with password 'Gauss_123';
create user rsr_test02 with password 'Gauss_123';
--schema 的属主是 rsr_test01
create schema rsr_schema01 AUTHORIZATION rsr_test01;
set role rsr_test01 password 'Gauss_123';
--表的属主是rsr_test01
create table rsr_schema01.tab21 (
  col set('beijing','shanghai', 'nanjing', 'wuhan', 'shenzhen')
);
NOTICE:  CREATE TABLE will create implicit set "tab21_col_set" for column "tab21.col"
reset role;
--修改表的属主是 rsr_test02
alter type rsr_schema01.tab21_col_set owner to rsr_test02; -- not support
ERROR:  not support to change owner of set type
alter table rsr_schema01.tab21 OWNER TO rsr_test02;
-- owner should be the same
select (select typowner from pg_type where typname = 'tab21_col_set') = (select relowner from pg_class where relname = 'tab21');
 ?column? 
----------
 t
(1 row)

drop table rsr_schema01.tab21;
select count(*) from pg_type where typname = 'tab21_col_set'; -- expect 0
 count 
-------
     0
(1 row)

-- alter table schema test
create user set_test01 with password 'Gauss_123';
create user set_test02 with password 'Gauss_123';
create schema set_schema01 AUTHORIZATION set_test01;
create schema set_schema02 AUTHORIZATION set_test02;
create table set_schema01.set_table (col set('beijing','shanghai', 'nanjing', 'wuhan', 'shenzhen'));
NOTICE:  CREATE TABLE will create implicit set "set_table_col_set" for column "set_table.col"
select (select typnamespace from pg_type where typname ='set_table_col_set')=(select relnamespace from pg_class where relname= 'set_table');
 ?column? 
----------
 t
(1 row)

-- change the namespace of table
alter table set_schema01.set_table set schema set_schema02;
-- namespace and owner should be the same
select (select typnamespace from pg_type where typname ='set_table_col_set')=(select relnamespace from pg_class where relname= 'set_table');
 ?column? 
----------
 t
(1 row)

drop user set_test01 cascade;
select * from set_schema02.set_table;
 col 
-----
(0 rows)

drop table set_schema02.set_table;
-- modify set col to non-set type
alter table test_set_tab modify c1 date;
ERROR:  column "c1" cannot be cast automatically to type date
HINT:  Specify a USING expression to perform the conversion.
alter table test_set_tab modify c1 time;
ERROR:  column "c1" cannot be cast automatically to type time without time zone
HINT:  Specify a USING expression to perform the conversion.
alter table test_set_tab modify c1 int;
alter table test_set_tab modify c2 char(10);
select c2, length(c2) from test_set_tab order by c2;
     c2     | length 
------------+--------
 a          |      1
 a,b        |      3
 a,b,c      |      5
 b          |      1
 c          |      1
(5 rows)

alter table test_set_tab modify c4 float4;
alter table test_set_tab modify c5 float8;
ERROR:  invalid input syntax for type double precision: "04-13-2022"
select count(distinct settypid) from pg_set; -- expect 3, some set types have deleted.
 count 
-------
     3
(1 row)

-- drop table's set column
drop type test_set_tab_part_c1_set; -- failed
ERROR:  cannot drop type test_set_tab_part_c1_set because other objects depend on it
DETAIL:  table test_set_tab_part column c1 depends on type test_set_tab_part_c1_set
HINT:  Use DROP ... CASCADE to drop the dependent objects too.
alter table test_set_tab_part drop c1;
select count(distinct settypid) from pg_set; -- expect 2
 count 
-------
     2
(1 row)

-- drop table constains set column
drop table test_set_tab;
select count(distinct settypid) from pg_set; -- expect 1
 count 
-------
     1
(1 row)

-- flash back test for ustore table
create table test_ustore_set (c1 set('n1', 'n2', 'n3'), c2 int) with (storage_type=ustore);
NOTICE:  CREATE TABLE will create implicit set "test_ustore_set_c1_set" for column "test_ustore_set.c1"
select count(*) from pg_set where settypid = (select oid from pg_type where typname='test_ustore_set_c1_set'); -- expect 3
 count 
-------
     3
(1 row)

drop table test_ustore_set;
select count(*) from pg_set where settypid = (select oid from pg_type where typname='test_ustore_set_c1_set'); -- expect 0
 count 
-------
     0
(1 row)

select * from gs_recyclebin where rcyoriginname='test_ustore_set_c1_set'; -- no output
 rcybaseid | rcydbid | rcyrelid | rcyname | rcyoriginname | rcyoperation | rcytype | rcyrecyclecsn | rcyrecycletime | rcycreatecsn | rcychangecsn | rcynamespace | rcyowner | rcytablespace | rcyrelfilenode | rcycanrestore | rcycanpurge | rcyfrozenxid | rcyfrozenxid64 
-----------+---------+----------+---------+---------------+--------------+---------+---------------+----------------+--------------+--------------+--------------+----------+---------------+----------------+---------------+-------------+--------------+----------------
(0 rows)

-- drop schema test
create schema s1;
create table s1.tab (col set('s1.a', 's1.b'));
NOTICE:  CREATE TABLE will create implicit set "tab_col_set" for column "tab.col"
drop schema s1; -- failed
ERROR:  cannot drop schema s1 because other objects depend on it
DETAIL:  type s1.tab_col_set depends on schema s1
table s1.tab depends on schema s1
HINT:  Use DROP ... CASCADE to drop the dependent objects too.
drop schema s1 cascade;
NOTICE:  drop cascades to 2 other objects
DETAIL:  drop cascades to type s1.tab_col_set
drop cascades to table s1.tab
drop table if exists test_cons_set;
NOTICE:  table "test_cons_set" does not exist, skipping
create table test_cons_set (c1 int check (c1 >= 10), c2 varchar(30) check(regexp_count(c2, 'a.b') = 1), c3 set('a', 'b', 'c', 'd') check (c3 > c1));
NOTICE:  CREATE TABLE will create implicit set "test_cons_set_c3_set" for column "test_cons_set.c3"
insert into test_cons_set values (10, 'a,b,d', 11);
insert into test_cons_set values (11, 'a-b', 'c,d');
alter table test_cons_set modify c1 set('a', 'b'); -- failed
NOTICE:  ALTER TABLE will create implicit set "test_cons_set_c1_set" for column "test_cons_set.c1"
ERROR:  invalid input value for set test_cons_set_c1_set: 10
alter table test_cons_set modify c1 set('a', 'b', 'c', 'd'); -- succeed
NOTICE:  ALTER TABLE will create implicit set "test_cons_set_c1_set" for column "test_cons_set.c1"
ERROR:  check constraint "test_cons_set_check" is violated by some row
\d test_cons_set
        Table "public.test_cons_set"
 Column |         Type          | Modifiers 
--------+-----------------------+-----------
 c1     | integer               | 
 c2     | character varying(30) | 
 c3     | test_cons_set_c3_set  | 
Check constraints:
    "test_cons_set_c1_check" CHECK (c1 >= 10)
    "test_cons_set_c2_check" CHECK (regexp_count(c2::text, 'a.b'::text) = 1)
    "test_cons_set_check" CHECK (c3 > c1)

alter table test_cons_set modify c2 set('a','b','c','d'); -- failed
NOTICE:  ALTER TABLE will create implicit set "test_cons_set_c2_set" for column "test_cons_set.c2"
ERROR:  invalid input value for set test_cons_set_c2_set: 'a-b'
delete from test_cons_set where c2 = 'a-b';
insert into test_cons_set values (12, 'a,b', 'a,c,d');
alter table test_cons_set modify c2 set('d', 'c', 'b', 'a'); -- failed, constaint conflict
NOTICE:  ALTER TABLE will create implicit set "test_cons_set_c2_set" for column "test_cons_set.c2"
ERROR:  check constraint "test_cons_set_c2_check" is violated by some row
-- test insert
drop table if exists ins_test_set;
NOTICE:  table "ins_test_set" does not exist, skipping
create table ins_test_set (
  c1 set('1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64'),
  c2 set('1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63'),
  c3 set('a', 'b', '', 'd', 'e', 'f')
);
NOTICE:  CREATE TABLE will create implicit set "ins_test_set_c1_set" for column "ins_test_set.c1"
NOTICE:  CREATE TABLE will create implicit set "ins_test_set_c2_set" for column "ins_test_set.c2"
NOTICE:  CREATE TABLE will create implicit set "ins_test_set_c3_set" for column "ins_test_set.c3"
-- display the new set type and its members
\dT+ ins_test_set_c1_set;
                                           List of data types
 Schema |        Name         |    Internal name    | Size | Elements | Access privileges | Description 
--------+---------------------+---------------------+------+----------+-------------------+-------------
 public | ins_test_set_c1_set | ins_test_set_c1_set | var  | 1       +|                   | 
        |                     |                     |      | 2       +|                   | 
        |                     |                     |      | 3       +|                   | 
        |                     |                     |      | 4       +|                   | 
        |                     |                     |      | 5       +|                   | 
        |                     |                     |      | 6       +|                   | 
        |                     |                     |      | 7       +|                   | 
        |                     |                     |      | 8       +|                   | 
        |                     |                     |      | 9       +|                   | 
        |                     |                     |      | 10      +|                   | 
        |                     |                     |      | 11      +|                   | 
        |                     |                     |      | 12      +|                   | 
        |                     |                     |      | 13      +|                   | 
        |                     |                     |      | 14      +|                   | 
        |                     |                     |      | 15      +|                   | 
        |                     |                     |      | 16      +|                   | 
        |                     |                     |      | 17      +|                   | 
        |                     |                     |      | 18      +|                   | 
        |                     |                     |      | 19      +|                   | 
        |                     |                     |      | 20      +|                   | 
        |                     |                     |      | 21      +|                   | 
        |                     |                     |      | 22      +|                   | 
        |                     |                     |      | 23      +|                   | 
        |                     |                     |      | 24      +|                   | 
        |                     |                     |      | 25      +|                   | 
        |                     |                     |      | 26      +|                   | 
        |                     |                     |      | 27      +|                   | 
        |                     |                     |      | 28      +|                   | 
        |                     |                     |      | 29      +|                   | 
        |                     |                     |      | 30      +|                   | 
        |                     |                     |      | 31      +|                   | 
        |                     |                     |      | 32      +|                   | 
        |                     |                     |      | 33      +|                   | 
        |                     |                     |      | 34      +|                   | 
        |                     |                     |      | 35      +|                   | 
        |                     |                     |      | 36      +|                   | 
        |                     |                     |      | 37      +|                   | 
        |                     |                     |      | 38      +|                   | 
        |                     |                     |      | 39      +|                   | 
        |                     |                     |      | 40      +|                   | 
        |                     |                     |      | 41      +|                   | 
        |                     |                     |      | 42      +|                   | 
        |                     |                     |      | 43      +|                   | 
        |                     |                     |      | 44      +|                   | 
        |                     |                     |      | 45      +|                   | 
        |                     |                     |      | 46      +|                   | 
        |                     |                     |      | 47      +|                   | 
        |                     |                     |      | 48      +|                   | 
        |                     |                     |      | 49      +|                   | 
        |                     |                     |      | 50      +|                   | 
        |                     |                     |      | 51      +|                   | 
        |                     |                     |      | 52      +|                   | 
        |                     |                     |      | 53      +|                   | 
        |                     |                     |      | 54      +|                   | 
        |                     |                     |      | 55      +|                   | 
        |                     |                     |      | 56      +|                   | 
        |                     |                     |      | 57      +|                   | 
        |                     |                     |      | 58      +|                   | 
        |                     |                     |      | 59      +|                   | 
        |                     |                     |      | 60      +|                   | 
        |                     |                     |      | 61      +|                   | 
        |                     |                     |      | 62      +|                   | 
        |                     |                     |      | 63      +|                   | 
        |                     |                     |      | 64       |                   | 
(1 row)

\dT+ ins_test_set_c3_set;
                                           List of data types
 Schema |        Name         |    Internal name    | Size | Elements | Access privileges | Description 
--------+---------------------+---------------------+------+----------+-------------------+-------------
 public | ins_test_set_c3_set | ins_test_set_c3_set | var  | a       +|                   | 
        |                     |                     |      | b       +|                   | 
        |                     |                     |      |         +|                   | 
        |                     |                     |      | d       +|                   | 
        |                     |                     |      | e       +|                   | 
        |                     |                     |      | f        |                   | 
(1 row)

insert into ins_test_set (c1) values (0); -- empty set
insert into ins_test_set (c1) values (-1); -- succeed to set all 64-bit
insert into ins_test_set (c1) values (9223372036854775808); -- out of range, different from M*
ERROR:  bigint out of range
CONTEXT:  referenced column: c1
insert into ins_test_set (c1) values (-9223372036854775808); -- succeed to set 64th-bit
insert into ins_test_set (c1) values (9223372036854775807); -- succeed to set all 63-bit
insert into ins_test_set (c1) values (-9223372036854775809); -- out of range, different from M*
ERROR:  bigint out of range
CONTEXT:  referenced column: c1
select c1::bigint as digit, c1 from ins_test_set where c1 is not null order by c1;
        digit         |                                                                                           c1                                                                                           
----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 -9223372036854775808 | 64
                   -1 | 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64
                    0 | 
  9223372036854775807 | 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63
(4 rows)

insert into ins_test_set (c2) values (0); -- empty set
insert into ins_test_set (c2) values (-1); -- failed to set all 64-bit, out of the set range
ERROR:  invalid input value for set ins_test_set_c2_set: -1
CONTEXT:  referenced column: c2
insert into ins_test_set (c2) values (4611686018427387904); -- succeed to set 63th-bit
insert into ins_test_set (c2) values (9223372036854775807); -- succeed to set all 63-bit
insert into ins_test_set (c2) values (-9223372036854775808); -- failed to set 64th-bit, out of set range
ERROR:  invalid input value for set ins_test_set_c2_set: -9223372036854775808
CONTEXT:  referenced column: c2
insert into ins_test_set (c3) values (0);
insert into ins_test_set (c3) values (-1); -- failed, out of range
ERROR:  invalid input value for set ins_test_set_c3_set: -1
CONTEXT:  referenced column: c3
insert into ins_test_set (c3) values (31);
insert into ins_test_set (c3) values (32); -- failed, out of range
insert into ins_test_set (c3) values (31.49); -- to 31
insert into ins_test_set (c3) values (31.50); -- ceil(32), different from M*
insert into ins_test_set (c1)values ('2,1,1'); -- duplicate set member
insert into ins_test_set (c1) values ('1');
insert into ins_test_set (c1) values ('a'); -- fail
ERROR:  invalid input value for set ins_test_set_c1_set: 'a'
LINE 1: insert into ins_test_set (c1) values ('a');
                                              ^
CONTEXT:  referenced column: c1
insert into ins_test_set (c1) values ('65'); -- fail
ERROR:  invalid input value for set ins_test_set_c1_set: '65'
LINE 1: insert into ins_test_set (c1) values ('65');
                                              ^
CONTEXT:  referenced column: c1
insert into ins_test_set (c3) values (''); -- null if compatible with A
insert into ins_test_set (c3) values (',');
insert into ins_test_set (c3) values ('d,e,');
insert into ins_test_set (c3) values ('d,,e');
insert into ins_test_set (c3) values (',d,e');
insert into ins_test_set (c3) values ('A,a'); -- fail
ERROR:  invalid input value for set ins_test_set_c3_set: 'A'
LINE 1: insert into ins_test_set (c3) values ('A,a');
                                              ^
CONTEXT:  referenced column: c3
insert into ins_test_set (c3) values ('E,e');
ERROR:  invalid input value for set ins_test_set_c3_set: 'E'
LINE 1: insert into ins_test_set (c3) values ('E,e');
                                              ^
CONTEXT:  referenced column: c3
drop table if exists source_tab;
NOTICE:  table "source_tab" does not exist, skipping
create table source_tab (c_int2 int2, c_int4 int, c_int8 bigint, c_bool bool, c_char char(20), c_varchar varchar(20), c_nvarchar2 nvarchar2(20), c_numberic number, c_text text, c_float4 float4, c_float8 float8, c_date date, c_time time, c_interval interval, c_set set ('1','2'));
NOTICE:  CREATE TABLE will create implicit set "source_tab_c_set_set" for column "source_tab.c_set"
insert into source_tab values (
  12,
  3432,
  4611686018427387904,
  true,
  '1,2,3,64',
  '1,2,3,64',
  '1,2,3,64',
  12.5,
  '1,2,3,64',
  12.5,
  4611606018427387904.43,
  '2022-04-08 00:00:00',
  '16:20:12',
  '1 day',
  3
);
truncate table ins_test_set;
insert into ins_test_set (c1,c2) select c_int2,c_float4 from source_tab;
insert into ins_test_set (c1,c2) select c_int4,c_bool::int from source_tab;
insert into ins_test_set (c1,c2) select c_int8,'63' from source_tab;
insert into ins_test_set (c1,c2) select c_bool::int,'62' from source_tab;
--insert into ins_test_set (c1,c2) select c_char,c_numberic from source_tab; -- fail
insert into ins_test_set (c1,c2) select c_varchar,c_float8 from source_tab;
insert into ins_test_set (c1,c2) select c_nvarchar2,c_int2 from source_tab;
insert into ins_test_set (c1,c2) select c_numberic,c_int4 from source_tab;
insert into ins_test_set (c1,c2) select c_text, c_set from source_tab; -- fail
ERROR:  table row type and query-specified row type do not match
DETAIL:  Table has type ins_test_set_c2_set at ordinal position 2, but query expects source_tab_c_set_set.
insert into ins_test_set (c1,c2) select c_text, c_float8 from source_tab;
insert into ins_test_set (c1,c2) select c_float4,substr(c_text,1,5) from source_tab;
insert into ins_test_set (c1,c2) select c_float8,c_int8 from source_tab;
insert into ins_test_set (c1,c2) select c_date,',' from source_tab; -- fail, no convert path
ERROR:  column "c1" is of type ins_test_set_c1_set but expression is of type date
LINE 1: insert into ins_test_set (c1,c2) select c_date,',' from sour...
                                                ^
HINT:  You will need to rewrite or cast the expression.
CONTEXT:  referenced column: c1
insert into ins_test_set (c1,c2) select c_time,1 from source_tab; -- fail, no convert path
ERROR:  column "c1" is of type ins_test_set_c1_set but expression is of type time without time zone
LINE 1: insert into ins_test_set (c1,c2) select c_time,1 from source...
                                                ^
HINT:  You will need to rewrite or cast the expression.
CONTEXT:  referenced column: c1
insert into ins_test_set (c1,c2) select c_interval,1 from source_tab; -- fail, no convert path
ERROR:  column "c1" is of type ins_test_set_c1_set but expression is of type interval
LINE 1: insert into ins_test_set (c1,c2) select c_interval,1 from so...
                                                ^
HINT:  You will need to rewrite or cast the expression.
CONTEXT:  referenced column: c1
insert into ins_test_set (c1,c2) select c_set,1 from source_tab; -- fail, no convert path, different from M*
ERROR:  table row type and query-specified row type do not match
DETAIL:  Table has type ins_test_set_c1_set at ordinal position 1, but query expects source_tab_c_set_set.
insert into ins_test_set (c1,c2) select c_set::text, c_set::int from source_tab;
insert into ins_test_set (c1,c2) select c1,c2 from ins_test_set;
-- select test (operator(<,<=,=,!=,>,>=), type cast, join, index scan)
select c1::bigint as num, c1 from ins_test_set order by c1; -- 22 rows expect
         num          |                                                 c1                                                 
----------------------+----------------------------------------------------------------------------------------------------
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
                    1 | 1
                    1 | 1
                    3 | 1,2
                    3 | 1,2
                   12 | 3,4
                   12 | 3,4
                   12 | 3,4
                   12 | 3,4
                   13 | 1,3,4
                   13 | 1,3,4
                 3432 | 4,6,7,9,11,12
                 3432 | 4,6,7,9,11,12
  4611606018427387904 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
  4611606018427387904 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
  4611686018427387904 | 63
  4611686018427387904 | 63
(22 rows)

-- operator test
-- <
select c1+0, c2+0 from ins_test_set where c1 < c2 order by 1;  -- set < other set
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                   13 |                3432
                   13 |                3432
  4611606018427387904 | 4611686018427387904
  4611606018427387904 | 4611686018427387904
(12 rows)

select c1+0, c2+0 from ins_test_set where c1 < 0::int2 order by c1;  -- set < int2
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
(6 rows)

select c1+0, c2+0 from ins_test_set where c1 < (1<<30) order by c1; -- set < int4
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   12 |                  12
                   12 |                   7
                   12 |                  12
                   12 |                   7
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
(18 rows)

select c1+0, c2+0 from ins_test_set where c1 < (1::bigint<<62) order by 1; -- set < int8
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   12 |                  12
                   12 |                   7
                   12 |                  12
                   12 |                   7
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
  4611606018427387904 | 4611686018427387904
  4611606018427387904 | 4611686018427387904
(20 rows)

select c1 from ins_test_set where c1 < '4,3' order by 1; -- set < text
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1
 1
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
(18 rows)

select c1 from ins_test_set where c1 < true order by 1; -- set < bool
    c1    
----------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
(6 rows)

select c1 from ins_test_set where c1 < false order by 1; -- set < bool
    c1    
----------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
(6 rows)

select c1+0, c2+0 from ins_test_set where 0::int2 < c1 order by c1;  -- int2 < set
      ?column?       |      ?column?       
---------------------+---------------------
                   1 | 2305843009213693952
                   1 | 2305843009213693952
                   3 |                   3
                   3 |                   3
                  12 |                  12
                  12 |                   7
                  12 |                  12
                  12 |                   7
                  13 |                3432
                  13 |                3432
                3432 |                   1
                3432 |                   1
 4611606018427387904 | 4611686018427387904
 4611606018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(16 rows)

select c1+0, c2+0 from ins_test_set where (1<<30) < c1 order by c1; --  int4 < set
      ?column?       |      ?column?       
---------------------+---------------------
 4611606018427387904 | 4611686018427387904
 4611606018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(4 rows)

select c1+0, c2+0 from ins_test_set where (1::bigint<<62) < c1 order by 1; -- int8 < set
 ?column? | ?column? 
----------+----------
(0 rows)

select c1 from ins_test_set where '4,3' < c1 order by 1; -- text < set
      c1       
---------------
 4,6,7,9,11,12
 4,6,7,9,11,12
 63
 63
(4 rows)

select c1 from ins_test_set where true < c1 order by 1; -- bool < set
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 63
 63
(14 rows)

-- <=
select c1+0, c2+0 from ins_test_set where c1 <= c2 order by 1;  -- set <= other set
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   12 |                  12
                   12 |                  12
                   13 |                3432
                   13 |                3432
  4611606018427387904 | 4611686018427387904
  4611606018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
(18 rows)

select c1+0, c2+0 from ins_test_set where c1 <= 0::int2 order by c1;  -- set <= int2
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
(6 rows)

select c1+0, c2+0 from ins_test_set where c1 <= (1<<30) order by c1; -- set <= int4
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   12 |                  12
                   12 |                   7
                   12 |                  12
                   12 |                   7
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
(18 rows)

select c1+0, c2+0 from ins_test_set where c1 <= (1::bigint<<62) order by 1; -- set <= int8
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   12 |                  12
                   12 |                   7
                   12 |                  12
                   12 |                   7
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
  4611606018427387904 | 4611686018427387904
  4611606018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
(22 rows)

select c1 from ins_test_set where c1 <= '4,3' order by 1; -- set <= text
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1
 1
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
(18 rows)

select c1 from ins_test_set where c1 <= true order by 1; -- set <= bool
    c1    
----------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1
 1
(8 rows)

select c1 from ins_test_set where c1 <= false order by 1; -- set <= bool
    c1    
----------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
(6 rows)

select c1+0, c2+0 from ins_test_set where 0::int2 <= c1 order by c1;  -- int2 <= set
      ?column?       |      ?column?       
---------------------+---------------------
                   1 | 2305843009213693952
                   1 | 2305843009213693952
                   3 |                   3
                   3 |                   3
                  12 |                  12
                  12 |                   7
                  12 |                  12
                  12 |                   7
                  13 |                3432
                  13 |                3432
                3432 |                   1
                3432 |                   1
 4611606018427387904 | 4611686018427387904
 4611606018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(16 rows)

select c1+0, c2+0 from ins_test_set where (1<<30) <= c1 order by c1; --  int4 <= set
      ?column?       |      ?column?       
---------------------+---------------------
 4611606018427387904 | 4611686018427387904
 4611606018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(4 rows)

select c1+0, c2+0 from ins_test_set where (1::bigint<<62) <= c1 order by 1; -- int8 <= set
      ?column?       |      ?column?       
---------------------+---------------------
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(2 rows)

select c1 from ins_test_set where '4,3' <= c1 order by 1; -- text <= set
      c1       
---------------
 4,6,7,9,11,12
 4,6,7,9,11,12
 63
 63
(4 rows)

select c1 from ins_test_set where true <= c1 order by 1; -- bool <= set
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 63
 63
(16 rows)

-- <>
select c1+0, c2+0 from ins_test_set where c1 != c2 order by 1;  -- set <> other set
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 |                  12
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                   12 |                   7
                   12 |                   7
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
  4611606018427387904 | 4611686018427387904
  4611606018427387904 | 4611686018427387904
(16 rows)

select c1+0, c2+0 from ins_test_set where c1 <> 12::int2 order by c1;  -- set <> int2
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
  4611606018427387904 | 4611686018427387904
  4611606018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
(18 rows)

select c1+0, c2+0 from ins_test_set where c1 != (1<<30) order by c1; -- set <> int4
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   12 |                  12
                   12 |                   7
                   12 |                  12
                   12 |                   7
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
  4611606018427387904 | 4611686018427387904
  4611606018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
(22 rows)

select c1+0, c2+0 from ins_test_set where c1 != 4611606018427387904 order by 1; -- set <> int8
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   12 |                  12
                   12 |                   7
                   12 |                  12
                   12 |                   7
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
  4611686018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
(20 rows)

select c1 from ins_test_set where c1 != '1,2,3,64' order by 1; -- set <> text
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 63
 63
(16 rows)

select c1 from ins_test_set where c1 <> true order by 1; -- set < bool
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 63
 63
(20 rows)

select c1 from ins_test_set where c1 != false order by 1; -- set <> bool
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1
 1
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 63
 63
(22 rows)

select c1+0, c2+0 from ins_test_set where 12::int2 != c1 order by c1;  -- int2 <> set
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
  4611606018427387904 | 4611686018427387904
  4611606018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
(18 rows)

select c1+0, c2+0 from ins_test_set where (1<<30) != c1 order by c1; --  int4 <> set
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   12 |                  12
                   12 |                   7
                   12 |                  12
                   12 |                   7
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
  4611606018427387904 | 4611686018427387904
  4611606018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
(22 rows)

select c1+0, c2+0 from ins_test_set where 4611606018427387904 != c1 order by 1; -- int8 <> set
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   12 |                  12
                   12 |                   7
                   12 |                  12
                   12 |                   7
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
  4611686018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
(20 rows)

select c1 from ins_test_set where '1,2,3,64' != c1 order by 1; -- text <> set
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 63
 63
(16 rows)

select c1 from ins_test_set where true <> c1 order by 1; -- bool < set
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 63
 63
(20 rows)

-- >
select c1+0, c2+0 from ins_test_set where c1 > c2 order by 1;  -- set > other set
 ?column? | ?column? 
----------+----------
       12 |        7
       12 |        7
     3432 |        1
     3432 |        1
(4 rows)

select c1+0, c2+0 from ins_test_set where c1 > 0::int2 order by c1;  -- set > int2
      ?column?       |      ?column?       
---------------------+---------------------
                   1 | 2305843009213693952
                   1 | 2305843009213693952
                   3 |                   3
                   3 |                   3
                  12 |                  12
                  12 |                   7
                  12 |                  12
                  12 |                   7
                  13 |                3432
                  13 |                3432
                3432 |                   1
                3432 |                   1
 4611606018427387904 | 4611686018427387904
 4611606018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(16 rows)

select c1+0, c2+0 from ins_test_set where c1 > (1<<30) order by c1; -- set > int4
      ?column?       |      ?column?       
---------------------+---------------------
 4611606018427387904 | 4611686018427387904
 4611606018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(4 rows)

select c1+0, c2+0 from ins_test_set where c1 > (1::bigint<<62) order by 1; -- set > int8
 ?column? | ?column? 
----------+----------
(0 rows)

select c1 from ins_test_set where c1 > '4,3' order by 1; -- set > text
      c1       
---------------
 4,6,7,9,11,12
 4,6,7,9,11,12
 63
 63
(4 rows)

select c1 from ins_test_set where c1 > true order by 1; -- set > bool
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 63
 63
(14 rows)

select c1+0, c2+0 from ins_test_set where 0::int2 > c1 order by c1;  -- int2 > set
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
(6 rows)

select c1+0, c2+0 from ins_test_set where (1<<30) > c1 order by c1; --  int4 > set
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   12 |                  12
                   12 |                   7
                   12 |                  12
                   12 |                   7
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
(18 rows)

select c1+0, c2+0 from ins_test_set where (1::bigint<<62) > c1 order by 1; -- int8 > set
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   12 |                  12
                   12 |                   7
                   12 |                  12
                   12 |                   7
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
  4611606018427387904 | 4611686018427387904
  4611606018427387904 | 4611686018427387904
(20 rows)

select c1 from ins_test_set where '4,3' > c1 order by 1; -- text > set
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1
 1
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
(18 rows)

select c1 from ins_test_set where true > c1 order by 1; -- bool > set
    c1    
----------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
(6 rows)

-- >=
select c1+0, c2+0 from ins_test_set where c1 >= c2 order by 1;  -- set >= other set
      ?column?       |      ?column?       
---------------------+---------------------
                   3 |                   3
                   3 |                   3
                  12 |                  12
                  12 |                   7
                  12 |                  12
                  12 |                   7
                3432 |                   1
                3432 |                   1
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(10 rows)

select c1+0, c2+0 from ins_test_set where c1 >= 0::int2 order by c1;  -- set >= int2
      ?column?       |      ?column?       
---------------------+---------------------
                   1 | 2305843009213693952
                   1 | 2305843009213693952
                   3 |                   3
                   3 |                   3
                  12 |                  12
                  12 |                   7
                  12 |                  12
                  12 |                   7
                  13 |                3432
                  13 |                3432
                3432 |                   1
                3432 |                   1
 4611606018427387904 | 4611686018427387904
 4611606018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(16 rows)

select c1+0, c2+0 from ins_test_set where c1 >= (1<<30) order by c1; -- set >= int4
      ?column?       |      ?column?       
---------------------+---------------------
 4611606018427387904 | 4611686018427387904
 4611606018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(4 rows)

select c1+0, c2+0 from ins_test_set where c1 >= (1::bigint<<62) order by 1; -- set >= int8
      ?column?       |      ?column?       
---------------------+---------------------
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(2 rows)

select c1 from ins_test_set where c1 >= '4,3' order by 1; -- set >= text
      c1       
---------------
 4,6,7,9,11,12
 4,6,7,9,11,12
 63
 63
(4 rows)

select c1 from ins_test_set where c1 >= true order by 1; -- set >= bool
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 63
 63
(16 rows)

select c1+0, c2+0 from ins_test_set where 0::int2 >= c1 order by c1;  -- int2 >= set
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
(6 rows)

select c1+0, c2+0 from ins_test_set where (1<<30) >= c1 order by c1; --  int4 >= set
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   12 |                  12
                   12 |                   7
                   12 |                  12
                   12 |                   7
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
(18 rows)

select c1+0, c2+0 from ins_test_set where (1::bigint<<62) >= c1 order by 1; -- int8 >= set
       ?column?       |      ?column?       
----------------------+---------------------
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 | 4611606018427387904
 -9223372036854775801 |                  12
 -9223372036854775801 |                  12
 -9223372036854775801 | 4611606018427387904
                    1 | 2305843009213693952
                    1 | 2305843009213693952
                    3 |                   3
                    3 |                   3
                   12 |                  12
                   12 |                   7
                   12 |                  12
                   12 |                   7
                   13 |                3432
                   13 |                3432
                 3432 |                   1
                 3432 |                   1
  4611606018427387904 | 4611686018427387904
  4611606018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
  4611686018427387904 | 4611686018427387904
(22 rows)

select c1 from ins_test_set where '4,3' >= c1 order by 1; -- text >= set
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1
 1
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
(18 rows)

select c1 from ins_test_set where true >= c1 order by 1; -- bool >= set
    c1    
----------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1
 1
(8 rows)

-- =
select c1+0, c2+0 from ins_test_set where c1 = c2 order by 1;  -- set = other set
      ?column?       |      ?column?       
---------------------+---------------------
                   3 |                   3
                   3 |                   3
                  12 |                  12
                  12 |                  12
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(6 rows)

select c1+0, c2+0 from ins_test_set where c1 = 12::int2 order by c1;  -- set = int2
 ?column? | ?column? 
----------+----------
       12 |       12
       12 |        7
       12 |       12
       12 |        7
(4 rows)

select c1+0, c2+0 from ins_test_set where c1 = (1<<30) order by c1; -- set = int4
 ?column? | ?column? 
----------+----------
(0 rows)

select c1+0, c2+0 from ins_test_set where c1 = (1::bigint<<62) order by 1; -- set = int8
      ?column?       |      ?column?       
---------------------+---------------------
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(2 rows)

select c1 from ins_test_set where c1 = '1,2,3,64' order by 1; -- set = text
    c1    
----------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
(6 rows)

select c1 from ins_test_set where c1 = true order by 1; -- set = bool
 c1 
----
 1
 1
(2 rows)

select c1+0, c2+0 from ins_test_set where 12::int2 = c1 order by c1;  -- int2 = set
 ?column? | ?column? 
----------+----------
       12 |       12
       12 |        7
       12 |       12
       12 |        7
(4 rows)

select c1+0, c2+0 from ins_test_set where (1<<30) = c1 order by c1; --  int4 = set
 ?column? | ?column? 
----------+----------
(0 rows)

select c1+0, c2+0 from ins_test_set where (1::bigint<<62) = c1 order by 1; -- int8 = set
      ?column?       |      ?column?       
---------------------+---------------------
 4611686018427387904 | 4611686018427387904
 4611686018427387904 | 4611686018427387904
(2 rows)

select c1 from ins_test_set where '1,2,3,64' = c1 order by 1; -- text < set
    c1    
----------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
(6 rows)

select c1 from ins_test_set where true = c1 order by 1; -- bool = set
 c1 
----
 1
 1
(2 rows)

-- set convert to other type
select c1::int8,
       c1::text,
       c1::numeric,
       c1::float4,
       c1::float8,
       c1::varchar(30), -- truncate
       c1::char(30),
       c1::nvarchar2(30)
from ins_test_set order by 1;
          c1          |                                                 c1                                                 |          c1          |      c1      |          c1           |               c1               |               c1               |               c1               
----------------------+----------------------------------------------------------------------------------------------------+----------------------+--------------+-----------------------+--------------------------------+--------------------------------+--------------------------------
 -9223372036854775801 | 1,2,3,64                                                                                           | -9223372036854775801 | -9.22337e+18 | -9.22337203685478e+18 | 1,2,3,64                       | 1,2,3,64                       | 1,2,3,64
 -9223372036854775801 | 1,2,3,64                                                                                           | -9223372036854775801 | -9.22337e+18 | -9.22337203685478e+18 | 1,2,3,64                       | 1,2,3,64                       | 1,2,3,64
 -9223372036854775801 | 1,2,3,64                                                                                           | -9223372036854775801 | -9.22337e+18 | -9.22337203685478e+18 | 1,2,3,64                       | 1,2,3,64                       | 1,2,3,64
 -9223372036854775801 | 1,2,3,64                                                                                           | -9223372036854775801 | -9.22337e+18 | -9.22337203685478e+18 | 1,2,3,64                       | 1,2,3,64                       | 1,2,3,64
 -9223372036854775801 | 1,2,3,64                                                                                           | -9223372036854775801 | -9.22337e+18 | -9.22337203685478e+18 | 1,2,3,64                       | 1,2,3,64                       | 1,2,3,64
 -9223372036854775801 | 1,2,3,64                                                                                           | -9223372036854775801 | -9.22337e+18 | -9.22337203685478e+18 | 1,2,3,64                       | 1,2,3,64                       | 1,2,3,64
                    1 | 1                                                                                                  |                    1 |            1 |                     1 | 1                              | 1                              | 1
                    1 | 1                                                                                                  |                    1 |            1 |                     1 | 1                              | 1                              | 1
                    3 | 1,2                                                                                                |                    3 |            3 |                     3 | 1,2                            | 1,2                            | 1,2
                    3 | 1,2                                                                                                |                    3 |            3 |                     3 | 1,2                            | 1,2                            | 1,2
                   12 | 3,4                                                                                                |                   12 |           12 |                    12 | 3,4                            | 3,4                            | 3,4
                   12 | 3,4                                                                                                |                   12 |           12 |                    12 | 3,4                            | 3,4                            | 3,4
                   12 | 3,4                                                                                                |                   12 |           12 |                    12 | 3,4                            | 3,4                            | 3,4
                   12 | 3,4                                                                                                |                   12 |           12 |                    12 | 3,4                            | 3,4                            | 3,4
                   13 | 1,3,4                                                                                              |                   13 |           13 |                    13 | 1,3,4                          | 1,3,4                          | 1,3,4
                   13 | 1,3,4                                                                                              |                   13 |           13 |                    13 | 1,3,4                          | 1,3,4                          | 1,3,4
                 3432 | 4,6,7,9,11,12                                                                                      |                 3432 |         3432 |                  3432 | 4,6,7,9,11,12                  | 4,6,7,9,11,12                  | 4,6,7,9,11,12
                 3432 | 4,6,7,9,11,12                                                                                      |                 3432 |         3432 |                  3432 | 4,6,7,9,11,12                  | 4,6,7,9,11,12                  | 4,6,7,9,11,12
  4611606018427387904 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 |  4.61161e+18 |  4.61160601842739e+18 | 17,18,20,22,23,27,28,32,33,35, | 17,18,20,22,23,27,28,32,33,35, | 17,18,20,22,23,27,28,32,33,35,
  4611606018427387904 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 |  4.61161e+18 |  4.61160601842739e+18 | 17,18,20,22,23,27,28,32,33,35, | 17,18,20,22,23,27,28,32,33,35, | 17,18,20,22,23,27,28,32,33,35,
  4611686018427387904 | 63                                                                                                 |  4611686018427387904 |  4.61169e+18 |  4.61168601842739e+18 | 63                             | 63                             | 63
  4611686018427387904 | 63                                                                                                 |  4611686018427387904 |  4.61169e+18 |  4.61168601842739e+18 | 63                             | 63                             | 63
(22 rows)

-- join test
select a.c1, a.c1::bigint, b.c_int2 from ins_test_set a join source_tab b on a.c1 = b.c_int2 order by 1; -- join with int2, hash by value
 c1  | c1 | c_int2 
-----+----+--------
 3,4 | 12 |     12
 3,4 | 12 |     12
 3,4 | 12 |     12
 3,4 | 12 |     12
(4 rows)

select a.c1, a.c1::bigint, b.c_int2 from ins_test_set a join source_tab b on a.c1 > b.c_int2 order by 1; -- join with int2
                                                 c1                                                 |         c1          | c_int2 
----------------------------------------------------------------------------------------------------+---------------------+--------
 1,3,4                                                                                              |                  13 |     12
 1,3,4                                                                                              |                  13 |     12
 4,6,7,9,11,12                                                                                      |                3432 |     12
 4,6,7,9,11,12                                                                                      |                3432 |     12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 |     12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 |     12
 63                                                                                                 | 4611686018427387904 |     12
 63                                                                                                 | 4611686018427387904 |     12
(8 rows)

select a.c1, a.c1::bigint, b.c_int2 from ins_test_set a join source_tab b on a.c1 >= b.c_int2 order by 1; -- join with int2
                                                 c1                                                 |         c1          | c_int2 
----------------------------------------------------------------------------------------------------+---------------------+--------
 3,4                                                                                                |                  12 |     12
 3,4                                                                                                |                  12 |     12
 3,4                                                                                                |                  12 |     12
 3,4                                                                                                |                  12 |     12
 1,3,4                                                                                              |                  13 |     12
 1,3,4                                                                                              |                  13 |     12
 4,6,7,9,11,12                                                                                      |                3432 |     12
 4,6,7,9,11,12                                                                                      |                3432 |     12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 |     12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 |     12
 63                                                                                                 | 4611686018427387904 |     12
 63                                                                                                 | 4611686018427387904 |     12
(12 rows)

select a.c1, a.c1::bigint, b.c_int2 from ins_test_set a join source_tab b on a.c1 < b.c_int2 order by 1; -- join with int2
    c1    |          c1          | c_int2 
----------+----------------------+--------
 1,2,3,64 | -9223372036854775801 |     12
 1,2,3,64 | -9223372036854775801 |     12
 1,2,3,64 | -9223372036854775801 |     12
 1,2,3,64 | -9223372036854775801 |     12
 1,2,3,64 | -9223372036854775801 |     12
 1,2,3,64 | -9223372036854775801 |     12
 1        |                    1 |     12
 1        |                    1 |     12
 1,2      |                    3 |     12
 1,2      |                    3 |     12
(10 rows)

select a.c1, a.c1::bigint, b.c_int2 from ins_test_set a join source_tab b on a.c1 <= b.c_int2 order by 1; -- join with int2
    c1    |          c1          | c_int2 
----------+----------------------+--------
 1,2,3,64 | -9223372036854775801 |     12
 1,2,3,64 | -9223372036854775801 |     12
 1,2,3,64 | -9223372036854775801 |     12
 1,2,3,64 | -9223372036854775801 |     12
 1,2,3,64 | -9223372036854775801 |     12
 1,2,3,64 | -9223372036854775801 |     12
 1        |                    1 |     12
 1        |                    1 |     12
 1,2      |                    3 |     12
 1,2      |                    3 |     12
 3,4      |                   12 |     12
 3,4      |                   12 |     12
 3,4      |                   12 |     12
 3,4      |                   12 |     12
(14 rows)

select a.c1, a.c1::bigint, b.c_int4 from ins_test_set a join source_tab b on a.c1 = b.c_int4 order by 1; -- join with int4, hash by value
      c1       |  c1  | c_int4 
---------------+------+--------
 4,6,7,9,11,12 | 3432 |   3432
 4,6,7,9,11,12 | 3432 |   3432
(2 rows)

select a.c1, a.c1::bigint, b.c_int4 from ins_test_set a join source_tab b on a.c1 > b.c_int4 order by 1; -- join with int4
                                                 c1                                                 |         c1          | c_int4 
----------------------------------------------------------------------------------------------------+---------------------+--------
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 |   3432
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 |   3432
 63                                                                                                 | 4611686018427387904 |   3432
 63                                                                                                 | 4611686018427387904 |   3432
(4 rows)

select a.c1, a.c1::bigint, b.c_int4 from ins_test_set a join source_tab b on a.c1 >= b.c_int4 order by 1; -- join with int4
                                                 c1                                                 |         c1          | c_int4 
----------------------------------------------------------------------------------------------------+---------------------+--------
 4,6,7,9,11,12                                                                                      |                3432 |   3432
 4,6,7,9,11,12                                                                                      |                3432 |   3432
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 |   3432
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 |   3432
 63                                                                                                 | 4611686018427387904 |   3432
 63                                                                                                 | 4611686018427387904 |   3432
(6 rows)

select a.c1, a.c1::bigint, b.c_int4 from ins_test_set a join source_tab b on a.c1 < b.c_int4 order by 1; -- join with int4
    c1    |          c1          | c_int4 
----------+----------------------+--------
 1,2,3,64 | -9223372036854775801 |   3432
 1,2,3,64 | -9223372036854775801 |   3432
 1,2,3,64 | -9223372036854775801 |   3432
 1,2,3,64 | -9223372036854775801 |   3432
 1,2,3,64 | -9223372036854775801 |   3432
 1,2,3,64 | -9223372036854775801 |   3432
 1        |                    1 |   3432
 1        |                    1 |   3432
 1,2      |                    3 |   3432
 1,2      |                    3 |   3432
 3,4      |                   12 |   3432
 3,4      |                   12 |   3432
 3,4      |                   12 |   3432
 3,4      |                   12 |   3432
 1,3,4    |                   13 |   3432
 1,3,4    |                   13 |   3432
(16 rows)

select a.c1, a.c1::bigint, b.c_int4 from ins_test_set a join source_tab b on a.c1 <= b.c_int4 order by 1; -- join with int4
      c1       |          c1          | c_int4 
---------------+----------------------+--------
 1,2,3,64      | -9223372036854775801 |   3432
 1,2,3,64      | -9223372036854775801 |   3432
 1,2,3,64      | -9223372036854775801 |   3432
 1,2,3,64      | -9223372036854775801 |   3432
 1,2,3,64      | -9223372036854775801 |   3432
 1,2,3,64      | -9223372036854775801 |   3432
 1             |                    1 |   3432
 1             |                    1 |   3432
 1,2           |                    3 |   3432
 1,2           |                    3 |   3432
 3,4           |                   12 |   3432
 3,4           |                   12 |   3432
 3,4           |                   12 |   3432
 3,4           |                   12 |   3432
 1,3,4         |                   13 |   3432
 1,3,4         |                   13 |   3432
 4,6,7,9,11,12 |                 3432 |   3432
 4,6,7,9,11,12 |                 3432 |   3432
(18 rows)

select a.c1, a.c1::bigint, b.c_int8 from ins_test_set a join source_tab b on a.c1 = b.c_int8 order by 1; -- join with int8, hash by value
 c1 |         c1          |       c_int8        
----+---------------------+---------------------
 63 | 4611686018427387904 | 4611686018427387904
 63 | 4611686018427387904 | 4611686018427387904
(2 rows)

select a.c1, a.c1::bigint, b.c_int8 from ins_test_set a join source_tab b on a.c1 > b.c_int8 order by 1; -- join with int8
 c1 | c1 | c_int8 
----+----+--------
(0 rows)

select a.c1, a.c1::bigint, b.c_int8 from ins_test_set a join source_tab b on a.c1 >= b.c_int8 order by 1; -- join with int8
 c1 |         c1          |       c_int8        
----+---------------------+---------------------
 63 | 4611686018427387904 | 4611686018427387904
 63 | 4611686018427387904 | 4611686018427387904
(2 rows)

select a.c1, a.c1::bigint, b.c_int8 from ins_test_set a join source_tab b on a.c1 < b.c_int8 order by 1; -- join with int8
                                                 c1                                                 |          c1          |       c_int8        
----------------------------------------------------------------------------------------------------+----------------------+---------------------
 1,2,3,64                                                                                           | -9223372036854775801 | 4611686018427387904
 1,2,3,64                                                                                           | -9223372036854775801 | 4611686018427387904
 1,2,3,64                                                                                           | -9223372036854775801 | 4611686018427387904
 1,2,3,64                                                                                           | -9223372036854775801 | 4611686018427387904
 1,2,3,64                                                                                           | -9223372036854775801 | 4611686018427387904
 1,2,3,64                                                                                           | -9223372036854775801 | 4611686018427387904
 1                                                                                                  |                    1 | 4611686018427387904
 1                                                                                                  |                    1 | 4611686018427387904
 1,2                                                                                                |                    3 | 4611686018427387904
 1,2                                                                                                |                    3 | 4611686018427387904
 3,4                                                                                                |                   12 | 4611686018427387904
 3,4                                                                                                |                   12 | 4611686018427387904
 3,4                                                                                                |                   12 | 4611686018427387904
 3,4                                                                                                |                   12 | 4611686018427387904
 1,3,4                                                                                              |                   13 | 4611686018427387904
 1,3,4                                                                                              |                   13 | 4611686018427387904
 4,6,7,9,11,12                                                                                      |                 3432 | 4611686018427387904
 4,6,7,9,11,12                                                                                      |                 3432 | 4611686018427387904
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 4611686018427387904
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 4611686018427387904
(20 rows)

select a.c1, a.c1::bigint, b.c_int8 from ins_test_set a join source_tab b on a.c1 <= b.c_int8 order by 1; -- join with int8
                                                 c1                                                 |          c1          |       c_int8        
----------------------------------------------------------------------------------------------------+----------------------+---------------------
 1,2,3,64                                                                                           | -9223372036854775801 | 4611686018427387904
 1,2,3,64                                                                                           | -9223372036854775801 | 4611686018427387904
 1,2,3,64                                                                                           | -9223372036854775801 | 4611686018427387904
 1,2,3,64                                                                                           | -9223372036854775801 | 4611686018427387904
 1,2,3,64                                                                                           | -9223372036854775801 | 4611686018427387904
 1,2,3,64                                                                                           | -9223372036854775801 | 4611686018427387904
 1                                                                                                  |                    1 | 4611686018427387904
 1                                                                                                  |                    1 | 4611686018427387904
 1,2                                                                                                |                    3 | 4611686018427387904
 1,2                                                                                                |                    3 | 4611686018427387904
 3,4                                                                                                |                   12 | 4611686018427387904
 3,4                                                                                                |                   12 | 4611686018427387904
 3,4                                                                                                |                   12 | 4611686018427387904
 3,4                                                                                                |                   12 | 4611686018427387904
 1,3,4                                                                                              |                   13 | 4611686018427387904
 1,3,4                                                                                              |                   13 | 4611686018427387904
 4,6,7,9,11,12                                                                                      |                 3432 | 4611686018427387904
 4,6,7,9,11,12                                                                                      |                 3432 | 4611686018427387904
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 4611686018427387904
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 4611686018427387904
 63                                                                                                 |  4611686018427387904 | 4611686018427387904
 63                                                                                                 |  4611686018427387904 | 4611686018427387904
(22 rows)

select a.c1, a.c1::bigint, b.c_varchar from ins_test_set a join source_tab b on a.c1 = b.c_varchar order by 1; -- join with varchar
    c1    |          c1          | c_varchar 
----------+----------------------+-----------
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
(6 rows)

select a.c1, a.c1::bigint, b.c_varchar from ins_test_set a join source_tab b on a.c1 > b.c_varchar order by 1; -- join with varchar
                                                 c1                                                 |         c1          | c_varchar 
----------------------------------------------------------------------------------------------------+---------------------+-----------
 3,4                                                                                                |                  12 | 1,2,3,64
 3,4                                                                                                |                  12 | 1,2,3,64
 3,4                                                                                                |                  12 | 1,2,3,64
 3,4                                                                                                |                  12 | 1,2,3,64
 1,3,4                                                                                              |                  13 | 1,2,3,64
 1,3,4                                                                                              |                  13 | 1,2,3,64
 4,6,7,9,11,12                                                                                      |                3432 | 1,2,3,64
 4,6,7,9,11,12                                                                                      |                3432 | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 | 1,2,3,64
 63                                                                                                 | 4611686018427387904 | 1,2,3,64
 63                                                                                                 | 4611686018427387904 | 1,2,3,64
(12 rows)

select a.c1, a.c1::bigint, b.c_varchar from ins_test_set a join source_tab b on a.c1 >= b.c_varchar order by 1; -- join with varchar
                                                 c1                                                 |          c1          | c_varchar 
----------------------------------------------------------------------------------------------------+----------------------+-----------
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 3,4                                                                                                |                   12 | 1,2,3,64
 3,4                                                                                                |                   12 | 1,2,3,64
 3,4                                                                                                |                   12 | 1,2,3,64
 3,4                                                                                                |                   12 | 1,2,3,64
 1,3,4                                                                                              |                   13 | 1,2,3,64
 1,3,4                                                                                              |                   13 | 1,2,3,64
 4,6,7,9,11,12                                                                                      |                 3432 | 1,2,3,64
 4,6,7,9,11,12                                                                                      |                 3432 | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 1,2,3,64
 63                                                                                                 |  4611686018427387904 | 1,2,3,64
 63                                                                                                 |  4611686018427387904 | 1,2,3,64
(18 rows)

select a.c1, a.c1::bigint, b.c_varchar from ins_test_set a join source_tab b on a.c1 < b.c_varchar order by 1; -- join with varchar
 c1  | c1 | c_varchar 
-----+----+-----------
 1   |  1 | 1,2,3,64
 1   |  1 | 1,2,3,64
 1,2 |  3 | 1,2,3,64
 1,2 |  3 | 1,2,3,64
(4 rows)

select a.c1, a.c1::bigint, b.c_varchar from ins_test_set a join source_tab b on a.c1 <= b.c_varchar order by 1; -- join with varchar
    c1    |          c1          | c_varchar 
----------+----------------------+-----------
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1        |                    1 | 1,2,3,64
 1        |                    1 | 1,2,3,64
 1,2      |                    3 | 1,2,3,64
 1,2      |                    3 | 1,2,3,64
(10 rows)

select a.c1, a.c1::bigint, b.c_nvarchar2 from ins_test_set a join source_tab b on a.c1 = b.c_nvarchar2 order by 1; -- join with nvarchar2
    c1    |          c1          | c_nvarchar2 
----------+----------------------+-------------
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
(6 rows)

select a.c1, a.c1::bigint, b.c_nvarchar2 from ins_test_set a join source_tab b on a.c1 > b.c_nvarchar2 order by 1; -- join with nvarchar2
                                                 c1                                                 |         c1          | c_nvarchar2 
----------------------------------------------------------------------------------------------------+---------------------+-------------
 3,4                                                                                                |                  12 | 1,2,3,64
 3,4                                                                                                |                  12 | 1,2,3,64
 3,4                                                                                                |                  12 | 1,2,3,64
 3,4                                                                                                |                  12 | 1,2,3,64
 1,3,4                                                                                              |                  13 | 1,2,3,64
 1,3,4                                                                                              |                  13 | 1,2,3,64
 4,6,7,9,11,12                                                                                      |                3432 | 1,2,3,64
 4,6,7,9,11,12                                                                                      |                3432 | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 | 1,2,3,64
 63                                                                                                 | 4611686018427387904 | 1,2,3,64
 63                                                                                                 | 4611686018427387904 | 1,2,3,64
(12 rows)

select a.c1, a.c1::bigint, b.c_nvarchar2 from ins_test_set a join source_tab b on a.c1 >= b.c_nvarchar2 order by 1; -- join with nvarchar2
                                                 c1                                                 |          c1          | c_nvarchar2 
----------------------------------------------------------------------------------------------------+----------------------+-------------
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 3,4                                                                                                |                   12 | 1,2,3,64
 3,4                                                                                                |                   12 | 1,2,3,64
 3,4                                                                                                |                   12 | 1,2,3,64
 3,4                                                                                                |                   12 | 1,2,3,64
 1,3,4                                                                                              |                   13 | 1,2,3,64
 1,3,4                                                                                              |                   13 | 1,2,3,64
 4,6,7,9,11,12                                                                                      |                 3432 | 1,2,3,64
 4,6,7,9,11,12                                                                                      |                 3432 | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 1,2,3,64
 63                                                                                                 |  4611686018427387904 | 1,2,3,64
 63                                                                                                 |  4611686018427387904 | 1,2,3,64
(18 rows)

select a.c1, a.c1::bigint, b.c_nvarchar2 from ins_test_set a join source_tab b on a.c1 < b.c_nvarchar2 order by 1; -- join with nvarchar2
 c1  | c1 | c_nvarchar2 
-----+----+-------------
 1   |  1 | 1,2,3,64
 1   |  1 | 1,2,3,64
 1,2 |  3 | 1,2,3,64
 1,2 |  3 | 1,2,3,64
(4 rows)

select a.c1, a.c1::bigint, b.c_nvarchar2 from ins_test_set a join source_tab b on a.c1 <= b.c_nvarchar2 order by 1; -- join with nvarchar2
    c1    |          c1          | c_nvarchar2 
----------+----------------------+-------------
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1        |                    1 | 1,2,3,64
 1        |                    1 | 1,2,3,64
 1,2      |                    3 | 1,2,3,64
 1,2      |                    3 | 1,2,3,64
(10 rows)

select a.c1, a.c1::bigint, b.c_char from ins_test_set a join source_tab b on a.c1 =  b.c_char order by 1; -- join with char
    c1    |          c1          |        c_char        
----------+----------------------+----------------------
 1,2,3,64 | -9223372036854775801 | 1,2,3,64            
 1,2,3,64 | -9223372036854775801 | 1,2,3,64            
 1,2,3,64 | -9223372036854775801 | 1,2,3,64            
 1,2,3,64 | -9223372036854775801 | 1,2,3,64            
 1,2,3,64 | -9223372036854775801 | 1,2,3,64            
 1,2,3,64 | -9223372036854775801 | 1,2,3,64            
(6 rows)

select a.c1, a.c1::bigint, b.c_char from ins_test_set a join source_tab b on a.c1 >  b.c_char order by 1; -- join with char
                                                 c1                                                 |         c1          |        c_char        
----------------------------------------------------------------------------------------------------+---------------------+----------------------
 3,4                                                                                                |                  12 | 1,2,3,64            
 3,4                                                                                                |                  12 | 1,2,3,64            
 3,4                                                                                                |                  12 | 1,2,3,64            
 3,4                                                                                                |                  12 | 1,2,3,64            
 1,3,4                                                                                              |                  13 | 1,2,3,64            
 1,3,4                                                                                              |                  13 | 1,2,3,64            
 4,6,7,9,11,12                                                                                      |                3432 | 1,2,3,64            
 4,6,7,9,11,12                                                                                      |                3432 | 1,2,3,64            
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 | 1,2,3,64            
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 | 1,2,3,64            
 63                                                                                                 | 4611686018427387904 | 1,2,3,64            
 63                                                                                                 | 4611686018427387904 | 1,2,3,64            
(12 rows)

select a.c1, a.c1::bigint, b.c_char from ins_test_set a join source_tab b on a.c1 >= b.c_char order by 1; -- join with char
                                                 c1                                                 |          c1          |        c_char        
----------------------------------------------------------------------------------------------------+----------------------+----------------------
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64            
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64            
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64            
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64            
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64            
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64            
 3,4                                                                                                |                   12 | 1,2,3,64            
 3,4                                                                                                |                   12 | 1,2,3,64            
 3,4                                                                                                |                   12 | 1,2,3,64            
 3,4                                                                                                |                   12 | 1,2,3,64            
 1,3,4                                                                                              |                   13 | 1,2,3,64            
 1,3,4                                                                                              |                   13 | 1,2,3,64            
 4,6,7,9,11,12                                                                                      |                 3432 | 1,2,3,64            
 4,6,7,9,11,12                                                                                      |                 3432 | 1,2,3,64            
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 1,2,3,64            
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 1,2,3,64            
 63                                                                                                 |  4611686018427387904 | 1,2,3,64            
 63                                                                                                 |  4611686018427387904 | 1,2,3,64            
(18 rows)

select a.c1, a.c1::bigint, b.c_char from ins_test_set a join source_tab b on a.c1 <  b.c_char order by 1; -- join with char
 c1  | c1 |        c_char        
-----+----+----------------------
 1   |  1 | 1,2,3,64            
 1   |  1 | 1,2,3,64            
 1,2 |  3 | 1,2,3,64            
 1,2 |  3 | 1,2,3,64            
(4 rows)

select a.c1, a.c1::bigint, b.c_char from ins_test_set a join source_tab b on a.c1 <= b.c_char order by 1; -- join with char
    c1    |          c1          |        c_char        
----------+----------------------+----------------------
 1,2,3,64 | -9223372036854775801 | 1,2,3,64            
 1,2,3,64 | -9223372036854775801 | 1,2,3,64            
 1,2,3,64 | -9223372036854775801 | 1,2,3,64            
 1,2,3,64 | -9223372036854775801 | 1,2,3,64            
 1,2,3,64 | -9223372036854775801 | 1,2,3,64            
 1,2,3,64 | -9223372036854775801 | 1,2,3,64            
 1        |                    1 | 1,2,3,64            
 1        |                    1 | 1,2,3,64            
 1,2      |                    3 | 1,2,3,64            
 1,2      |                    3 | 1,2,3,64            
(10 rows)

select a.c1, a.c1::bigint, b.c_text from ins_test_set a join source_tab b on a.c1 =  b.c_text order by 1; -- join with text
    c1    |          c1          |  c_text  
----------+----------------------+----------
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
(6 rows)

select a.c1, a.c1::bigint, b.c_text from ins_test_set a join source_tab b on a.c1 >  b.c_text order by 1; -- join with text
                                                 c1                                                 |         c1          |  c_text  
----------------------------------------------------------------------------------------------------+---------------------+----------
 3,4                                                                                                |                  12 | 1,2,3,64
 3,4                                                                                                |                  12 | 1,2,3,64
 3,4                                                                                                |                  12 | 1,2,3,64
 3,4                                                                                                |                  12 | 1,2,3,64
 1,3,4                                                                                              |                  13 | 1,2,3,64
 1,3,4                                                                                              |                  13 | 1,2,3,64
 4,6,7,9,11,12                                                                                      |                3432 | 1,2,3,64
 4,6,7,9,11,12                                                                                      |                3432 | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 | 1,2,3,64
 63                                                                                                 | 4611686018427387904 | 1,2,3,64
 63                                                                                                 | 4611686018427387904 | 1,2,3,64
(12 rows)

select a.c1, a.c1::bigint, b.c_text from ins_test_set a join source_tab b on a.c1 >= b.c_text order by 1; -- join with text
                                                 c1                                                 |          c1          |  c_text  
----------------------------------------------------------------------------------------------------+----------------------+----------
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2,3,64
 3,4                                                                                                |                   12 | 1,2,3,64
 3,4                                                                                                |                   12 | 1,2,3,64
 3,4                                                                                                |                   12 | 1,2,3,64
 3,4                                                                                                |                   12 | 1,2,3,64
 1,3,4                                                                                              |                   13 | 1,2,3,64
 1,3,4                                                                                              |                   13 | 1,2,3,64
 4,6,7,9,11,12                                                                                      |                 3432 | 1,2,3,64
 4,6,7,9,11,12                                                                                      |                 3432 | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 1,2,3,64
 63                                                                                                 |  4611686018427387904 | 1,2,3,64
 63                                                                                                 |  4611686018427387904 | 1,2,3,64
(18 rows)

select a.c1, a.c1::bigint, b.c_text from ins_test_set a join source_tab b on a.c1 <  b.c_text order by 1; -- join with text
 c1  | c1 |  c_text  
-----+----+----------
 1   |  1 | 1,2,3,64
 1   |  1 | 1,2,3,64
 1,2 |  3 | 1,2,3,64
 1,2 |  3 | 1,2,3,64
(4 rows)

select a.c1, a.c1::bigint, b.c_text from ins_test_set a join source_tab b on a.c1 <= b.c_text order by 1; -- join with text
    c1    |          c1          |  c_text  
----------+----------------------+----------
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1,2,3,64 | -9223372036854775801 | 1,2,3,64
 1        |                    1 | 1,2,3,64
 1        |                    1 | 1,2,3,64
 1,2      |                    3 | 1,2,3,64
 1,2      |                    3 | 1,2,3,64
(10 rows)

select a.c1, a.c1::bigint, b.c_bool from ins_test_set a join source_tab b on a.c1 =  b.c_bool order by 1; -- join with bool
 c1 | c1 | c_bool 
----+----+--------
 1  |  1 | t
 1  |  1 | t
(2 rows)

select a.c1, a.c1::bigint, b.c_bool from ins_test_set a join source_tab b on a.c1 >  b.c_bool order by 1; -- join with bool
                                                 c1                                                 |         c1          | c_bool 
----------------------------------------------------------------------------------------------------+---------------------+--------
 1,2                                                                                                |                   3 | t
 1,2                                                                                                |                   3 | t
 3,4                                                                                                |                  12 | t
 3,4                                                                                                |                  12 | t
 3,4                                                                                                |                  12 | t
 3,4                                                                                                |                  12 | t
 1,3,4                                                                                              |                  13 | t
 1,3,4                                                                                              |                  13 | t
 4,6,7,9,11,12                                                                                      |                3432 | t
 4,6,7,9,11,12                                                                                      |                3432 | t
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 | t
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 | t
 63                                                                                                 | 4611686018427387904 | t
 63                                                                                                 | 4611686018427387904 | t
(14 rows)

select a.c1, a.c1::bigint, b.c_bool from ins_test_set a join source_tab b on a.c1 >= b.c_bool order by 1; -- join with bool
                                                 c1                                                 |         c1          | c_bool 
----------------------------------------------------------------------------------------------------+---------------------+--------
 1                                                                                                  |                   1 | t
 1                                                                                                  |                   1 | t
 1,2                                                                                                |                   3 | t
 1,2                                                                                                |                   3 | t
 3,4                                                                                                |                  12 | t
 3,4                                                                                                |                  12 | t
 3,4                                                                                                |                  12 | t
 3,4                                                                                                |                  12 | t
 1,3,4                                                                                              |                  13 | t
 1,3,4                                                                                              |                  13 | t
 4,6,7,9,11,12                                                                                      |                3432 | t
 4,6,7,9,11,12                                                                                      |                3432 | t
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 | t
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | 4611606018427387904 | t
 63                                                                                                 | 4611686018427387904 | t
 63                                                                                                 | 4611686018427387904 | t
(16 rows)

select a.c1, a.c1::bigint, b.c_bool from ins_test_set a join source_tab b on a.c1 <  b.c_bool order by 1; -- join with bool
    c1    |          c1          | c_bool 
----------+----------------------+--------
 1,2,3,64 | -9223372036854775801 | t
 1,2,3,64 | -9223372036854775801 | t
 1,2,3,64 | -9223372036854775801 | t
 1,2,3,64 | -9223372036854775801 | t
 1,2,3,64 | -9223372036854775801 | t
 1,2,3,64 | -9223372036854775801 | t
(6 rows)

select a.c1, a.c1::bigint, b.c_bool from ins_test_set a join source_tab b on a.c1 <= b.c_bool order by 1; -- join with bool
    c1    |          c1          | c_bool 
----------+----------------------+--------
 1,2,3,64 | -9223372036854775801 | t
 1,2,3,64 | -9223372036854775801 | t
 1,2,3,64 | -9223372036854775801 | t
 1,2,3,64 | -9223372036854775801 | t
 1,2,3,64 | -9223372036854775801 | t
 1,2,3,64 | -9223372036854775801 | t
 1        |                    1 | t
 1        |                    1 | t
(8 rows)

select a.c1, a.c1::bigint, b.c_set from ins_test_set a join source_tab b on a.c1 =  b.c_set order by 1; -- join with set
 c1  | c1 | c_set 
-----+----+-------
 1,2 |  3 | 1,2
 1,2 |  3 | 1,2
(2 rows)

select a.c1, a.c1::bigint, b.c_set from ins_test_set a join source_tab b on a.c1 >  b.c_set order by 1; -- join with set
                                                 c1                                                 |          c1          | c_set 
----------------------------------------------------------------------------------------------------+----------------------+-------
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2
 3,4                                                                                                |                   12 | 1,2
 3,4                                                                                                |                   12 | 1,2
 3,4                                                                                                |                   12 | 1,2
 3,4                                                                                                |                   12 | 1,2
 1,3,4                                                                                              |                   13 | 1,2
 1,3,4                                                                                              |                   13 | 1,2
 4,6,7,9,11,12                                                                                      |                 3432 | 1,2
 4,6,7,9,11,12                                                                                      |                 3432 | 1,2
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 1,2
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 1,2
 63                                                                                                 |  4611686018427387904 | 1,2
 63                                                                                                 |  4611686018427387904 | 1,2
(18 rows)

select a.c1, a.c1::bigint, b.c_set from ins_test_set a join source_tab b on a.c1 >= b.c_set order by 1; -- join with set
                                                 c1                                                 |          c1          | c_set 
----------------------------------------------------------------------------------------------------+----------------------+-------
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2
 1,2,3,64                                                                                           | -9223372036854775801 | 1,2
 1,2                                                                                                |                    3 | 1,2
 1,2                                                                                                |                    3 | 1,2
 3,4                                                                                                |                   12 | 1,2
 3,4                                                                                                |                   12 | 1,2
 3,4                                                                                                |                   12 | 1,2
 3,4                                                                                                |                   12 | 1,2
 1,3,4                                                                                              |                   13 | 1,2
 1,3,4                                                                                              |                   13 | 1,2
 4,6,7,9,11,12                                                                                      |                 3432 | 1,2
 4,6,7,9,11,12                                                                                      |                 3432 | 1,2
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 1,2
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |  4611606018427387904 | 1,2
 63                                                                                                 |  4611686018427387904 | 1,2
 63                                                                                                 |  4611686018427387904 | 1,2
(20 rows)

select a.c1, a.c1::bigint, b.c_set from ins_test_set a join source_tab b on a.c1 <  b.c_set order by 1; -- join with set
 c1 | c1 | c_set 
----+----+-------
 1  |  1 | 1,2
 1  |  1 | 1,2
(2 rows)

select a.c1, a.c1::bigint, b.c_set from ins_test_set a join source_tab b on a.c1 <= b.c_set order by 1; -- join with set
 c1  | c1 | c_set 
-----+----+-------
 1   |  1 | 1,2
 1   |  1 | 1,2
 1,2 |  3 | 1,2
 1,2 |  3 | 1,2
(4 rows)

-- aggr/group/order/distinct/having/union/except/minus/limit/offset/case when/decode
select distinct c1::bigint as num, c1 from ins_test_set order by c1; -- 8 rows expect
         num          |                                                 c1                                                 
----------------------+----------------------------------------------------------------------------------------------------
 -9223372036854775801 | 1,2,3,64
                    1 | 1
                    3 | 1,2
                   12 | 3,4
                   13 | 1,3,4
                 3432 | 4,6,7,9,11,12
  4611606018427387904 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
  4611686018427387904 | 63
(8 rows)

select c1::bigint as num, c1 from ins_test_set group by c1 order by c1;
         num          |                                                 c1                                                 
----------------------+----------------------------------------------------------------------------------------------------
 -9223372036854775801 | 1,2,3,64
                    1 | 1
                    3 | 1,2
                   12 | 3,4
                   13 | 1,3,4
                 3432 | 4,6,7,9,11,12
  4611606018427387904 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
  4611686018427387904 | 63
(8 rows)

select c1::bigint as num, c1 from ins_test_set group by c1 + 1; -- fail
ERROR:  column "ins_test_set.c1" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select c1::bigint as num, c1 from ins_test_set group by c1 +...
               ^
select c1::bigint + 1 as num, c1 + 1 from ins_test_set group by c1 + 1 order by c1 + 1;
         num          |       ?column?       
----------------------+----------------------
 -9223372036854775800 | -9223372036854775800
                    2 |                    2
                    4 |                    4
                   13 |                   13
                   14 |                   14
                 3433 |                 3433
  4611606018427387905 |  4611606018427387905
  4611686018427387905 |  4611686018427387905
(8 rows)

select sum(c1) from ins_test_set;
          sum          
-----------------------
 -36893648147419096244
(1 row)

select sum(c1) from ins_test_set group by c1 order by c1;
          sum          
-----------------------
 -55340232221128654806
                     2
                     6
                    48
                    26
                  6864
   9223212036854775808
   9223372036854775808
(8 rows)

select avg(c1), c1::bigint + 1 as num, c1 + 1 from ins_test_set group by c1 + 1 having avg(c1) > 20 order by c1 + 1;
          avg          |         num         |      ?column?       
-----------------------+---------------------+---------------------
 3432.0000000000000000 |                3433 |                3433
   4611606018427387904 | 4611606018427387905 | 4611606018427387905
   4611686018427387904 | 4611686018427387905 | 4611686018427387905
(3 rows)

select c1::bigint as num, c1 from ins_test_set where exists (select c_int2 from source_tab where c_int2 < c1) order by 1;
         num         |                                                 c1                                                 
---------------------+----------------------------------------------------------------------------------------------------
                  13 | 1,3,4
                  13 | 1,3,4
                3432 | 4,6,7,9,11,12
                3432 | 4,6,7,9,11,12
 4611606018427387904 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 4611606018427387904 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 4611686018427387904 | 63
 4611686018427387904 | 63
(8 rows)

select c1::bigint as num, c1 from ins_test_set where not exists (select c_int2 from source_tab where c_int2 < c1) order by 1;
         num          |    c1    
----------------------+----------
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
                    1 | 1
                    1 | 1
                    3 | 1,2
                    3 | 1,2
                   12 | 3,4
                   12 | 3,4
                   12 | 3,4
                   12 | 3,4
(14 rows)

select c1::bigint as num, c1 from ins_test_set where c1 in (select c_int2 from source_tab) order by 1;
 num | c1  
-----+-----
  12 | 3,4
  12 | 3,4
  12 | 3,4
  12 | 3,4
(4 rows)

select c1::bigint as num, c1 from ins_test_set where c1 not in (select c_int2 from source_tab) order by 1;
         num          |                                                 c1                                                 
----------------------+----------------------------------------------------------------------------------------------------
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
                    1 | 1
                    1 | 1
                    3 | 1,2
                    3 | 1,2
                   13 | 1,3,4
                   13 | 1,3,4
                 3432 | 4,6,7,9,11,12
                 3432 | 4,6,7,9,11,12
  4611606018427387904 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
  4611606018427387904 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
  4611686018427387904 | 63
  4611686018427387904 | 63
(18 rows)

-- union test
-- set union set
select c1 from ins_test_set union all select c2 from ins_test_set order by 1;
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1
 1
 1
 1,2
 1,2
 1,2
 1,2
 1,2,3
 1,2,3
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,3,4
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 3,4
 3,4
 3,4
 3,4
 3,4
 3,4
 3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 4,6,7,9,11,12
 4,6,7,9,11,12
 62
 62
 63
 63
 63
 63
 63
 63
(44 rows)

select c1 from ins_test_set union select c2 from ins_test_set order by 1; -- hash by string, not set value
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1,2
 1,2,3
 1,2,3,64
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 4,6,7,9,11,12
 62
 63
(10 rows)

select c1 from ins_test_set union select c2 from ins_test_set union select c3 from ins_test_set order by 1; -- hash by string, not set value
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1,2
 1,2,3
 1,2,3,64
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 4,6,7,9,11,12
 62
 63
 
(11 rows)

-- set1 union set2
select c1 from ins_test_set union all select c_set from source_tab order by 1;
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1
 1,2
 1,2
 1,2
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,3,4
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 3,4
 3,4
 3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 63
 63
(23 rows)

select c1 from ins_test_set union select c_set from source_tab order by 1;
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1,2
 1,2,3,64
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 4,6,7,9,11,12
 63
(8 rows)

drop table if exists union_test;
NOTICE:  table "union_test" does not exist, skipping
create table union_test (c1 set('a','b','c','d'));
NOTICE:  CREATE TABLE will create implicit set "union_test_c1_set" for column "union_test.c1"
insert into union_test values ('a'),('b'),('c'),('d');
select c1 from ins_test_set union all select c1 from union_test order by 1;
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1
 1,2
 1,2
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,3,4
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 3,4
 3,4
 3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 63
 63
 a
 b
 c
 d
(26 rows)

select c1 from ins_test_set union select c1 from union_test order by 1; -- set values is the same, but string is different. hash by string
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1,2
 1,2,3,64
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 4,6,7,9,11,12
 63
 a
 b
 c
 d
(12 rows)

drop table union_test;
-- set union unknownoid(const string)
select c1 from ins_test_set union select 'ab' from dual order by 1;
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1,2
 1,2,3,64
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 4,6,7,9,11,12
 63
 ab
(9 rows)

select 'ab' from dual union select c1 from ins_test_set order by 1;
                                              ?column?                                              
----------------------------------------------------------------------------------------------------
 1
 1,2
 1,2,3,64
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 4,6,7,9,11,12
 63
 ab
(9 rows)

select 'ab' from dual union select c_int4 from source_tab order by 1; -- not changed
 ?column? 
----------
        0
     3432
(2 rows)

select '1' from dual union select c_int4 from source_tab order by 1; -- not changed
 ?column? 
----------
        1
     3432
(2 rows)

-- set union with datatypes in other type category
select c1 from ins_test_set union select c_int4 from source_tab order by 1;
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1,2
 1,2,3,64
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 3432
 4,6,7,9,11,12
 63
(9 rows)

select c1 from ins_test_set union select c_varchar from source_tab order by 1;
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1
 1,2
 1,2,3,64
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 4,6,7,9,11,12
 63
(8 rows)

select c1::bigint from ins_test_set union select c_int4 from source_tab order by 1;
          c1          
----------------------
 -9223372036854775801
                    1
                    3
                   12
                   13
                 3432
  4611606018427387904
  4611686018427387904
(8 rows)

-- case when
select case c1 when c1 <=0 then c1 + 1 when c1 > 0 and c1 < 100 then c1 || 'abc' else c1 end from ins_test_set order by 1; -- || is not string concat in M*
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1,2
 1,2
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,3,4
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 1abc
 1abc
 3,4
 3,4
 3,4
 3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 63
 63
(22 rows)

select c2, c3, case when c1 <=0 then c1 when c1 > 0 and c1 > 100 then c2 else c3 end as result from ins_test_set order by 1,2,3;
                                                 c2                                                 | c3 |  result  
----------------------------------------------------------------------------------------------------+----+----------
 1                                                                                                  |    | 1
 1                                                                                                  |    | 1
 1,2                                                                                                |    | 
 1,2                                                                                                |    | 
 1,2,3                                                                                              |    | 
 1,2,3                                                                                              |    | 
 3,4                                                                                                |    | 1,2,3,64
 3,4                                                                                                |    | 1,2,3,64
 3,4                                                                                                |    | 
 3,4                                                                                                |    | 
 4,6,7,9,11,12                                                                                      |    | 
 4,6,7,9,11,12                                                                                      |    | 
 62                                                                                                 |    | 
 62                                                                                                 |    | 
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | 1,2,3,64
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | 1,2,3,64
 63                                                                                                 |    | 63
 63                                                                                                 |    | 63
 63                                                                                                 |    | 63
 63                                                                                                 |    | 63
(22 rows)

select c1::bigint, c2, c3, case c1 when 0 then c1 when true then c2 when '1,2,3,64' then c3 else null end as result from ins_test_set order by 1,2,3,4;
          c1          |                                                 c2                                                 | c3 | result 
----------------------+----------------------------------------------------------------------------------------------------+----+--------
 -9223372036854775801 | 3,4                                                                                                |    | 
 -9223372036854775801 | 3,4                                                                                                |    | 
 -9223372036854775801 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | 
 -9223372036854775801 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | 
 -9223372036854775801 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | 
 -9223372036854775801 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | 
                    1 | 62                                                                                                 |    | 62
                    1 | 62                                                                                                 |    | 62
                    3 | 1,2                                                                                                |    | 
                    3 | 1,2                                                                                                |    | 
                   12 | 1,2,3                                                                                              |    | 
                   12 | 1,2,3                                                                                              |    | 
                   12 | 3,4                                                                                                |    | 
                   12 | 3,4                                                                                                |    | 
                   13 | 4,6,7,9,11,12                                                                                      |    | 
                   13 | 4,6,7,9,11,12                                                                                      |    | 
                 3432 | 1                                                                                                  |    | 
                 3432 | 1                                                                                                  |    | 
  4611606018427387904 | 63                                                                                                 |    | 
  4611606018427387904 | 63                                                                                                 |    | 
  4611686018427387904 | 63                                                                                                 |    | 
  4611686018427387904 | 63                                                                                                 |    | 
(22 rows)

-- decode
select c1::bigint, c2, c3, decode(c1, 0, c1, 1, c2, '1,2,3,64', 'c3', 'default') from ins_test_set order by 1,2,3,4;
          c1          |                                                 c2                                                 | c3 |  case   
----------------------+----------------------------------------------------------------------------------------------------+----+---------
 -9223372036854775801 | 3,4                                                                                                |    | c3
 -9223372036854775801 | 3,4                                                                                                |    | c3
 -9223372036854775801 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | c3
 -9223372036854775801 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | c3
 -9223372036854775801 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | c3
 -9223372036854775801 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | c3
                    1 | 62                                                                                                 |    | 62
                    1 | 62                                                                                                 |    | 62
                    3 | 1,2                                                                                                |    | default
                    3 | 1,2                                                                                                |    | default
                   12 | 1,2,3                                                                                              |    | default
                   12 | 1,2,3                                                                                              |    | default
                   12 | 3,4                                                                                                |    | default
                   12 | 3,4                                                                                                |    | default
                   13 | 4,6,7,9,11,12                                                                                      |    | default
                   13 | 4,6,7,9,11,12                                                                                      |    | default
                 3432 | 1                                                                                                  |    | default
                 3432 | 1                                                                                                  |    | default
  4611606018427387904 | 63                                                                                                 |    | default
  4611606018427387904 | 63                                                                                                 |    | default
  4611686018427387904 | 63                                                                                                 |    | default
  4611686018427387904 | 63                                                                                                 |    | default
(22 rows)

select c1::bigint, c2, c3, decode(c1, 0, 1, 1, c2, '1,2,3,64', 'c3', 'default') from ins_test_set order by 1,2,3,4;
          c1          |                                                 c2                                                 | c3 |  case   
----------------------+----------------------------------------------------------------------------------------------------+----+---------
 -9223372036854775801 | 3,4                                                                                                |    | c3
 -9223372036854775801 | 3,4                                                                                                |    | c3
 -9223372036854775801 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | c3
 -9223372036854775801 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | c3
 -9223372036854775801 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | c3
 -9223372036854775801 | 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 |    | c3
                    1 | 62                                                                                                 |    | 62
                    1 | 62                                                                                                 |    | 62
                    3 | 1,2                                                                                                |    | default
                    3 | 1,2                                                                                                |    | default
                   12 | 1,2,3                                                                                              |    | default
                   12 | 1,2,3                                                                                              |    | default
                   12 | 3,4                                                                                                |    | default
                   12 | 3,4                                                                                                |    | default
                   13 | 4,6,7,9,11,12                                                                                      |    | default
                   13 | 4,6,7,9,11,12                                                                                      |    | default
                 3432 | 1                                                                                                  |    | default
                 3432 | 1                                                                                                  |    | default
  4611606018427387904 | 63                                                                                                 |    | default
  4611606018427387904 | 63                                                                                                 |    | default
  4611686018427387904 | 63                                                                                                 |    | default
  4611686018427387904 | 63                                                                                                 |    | default
(22 rows)

-- between...and
select c1 from ins_test_set where c1 between 'a,b,c' and '1,2,3' order by 1;
 c1 
----
(0 rows)

select c1 from ins_test_set where c1 between 1 and '1,2,3' order by 1; -- different from M*
 c1  
-----
 1
 1
 1,2
 1,2
(4 rows)

select c1 from ins_test_set where c1 between '1,2' and 56.54 order by 1;
    c1    
----------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2
 1,2
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
(14 rows)

-- greatest/least/nvl/exists/not exists/in(subquery)/not in(subquery)/any/some/all/in(values)/
select greatest(c1, c2, c3) from ins_test_set order by 1; -- convert to text
                                              greatest                                              
----------------------------------------------------------------------------------------------------
 1,2
 1,2
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 3,4
 3,4
 3,4
 3,4
 3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 4,6,7,9,11,12
 4,6,7,9,11,12
 62
 62
 63
 63
 63
 63
(22 rows)

select least(c1, c2, c3) from ins_test_set order by 1; -- convert to text
                                               least                                                
----------------------------------------------------------------------------------------------------
 1
 1
 1
 1
 1,2
 1,2
 1,2,3
 1,2,3
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,3,4
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 3,4
 63
 63
(22 rows)

select greatest(c1, c2, 1) from ins_test_set order by 1;
                                              greatest                                              
----------------------------------------------------------------------------------------------------
 1,2
 1,2
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 3,4
 3,4
 3,4
 3,4
 3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 4,6,7,9,11,12
 4,6,7,9,11,12
 62
 62
 63
 63
 63
 63
(22 rows)

select least(c1, c2, 1) from ins_test_set order by 1;
 least 
-------
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
(22 rows)

select nvl(c1, 1) from ins_test_set order by 1; -- order by set value
                                                nvl                                                 
----------------------------------------------------------------------------------------------------
 1
 1
 1,2
 1,2
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,3,4
 1,3,4
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 3,4
 3,4
 3,4
 3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 63
 63
(22 rows)

select c1 from ins_test_set where c1 in (1, '1,2,3', 323.42, '2020-2-12'::date);
 c1 
----
 1
 1
(2 rows)

select distinct c1 from ins_test_set where c1 not in (1, '1,2,3', 323.42, '2020-2-12'::date, 4611606018427387904) order by 1;
      c1       
---------------
 1,2,3,64
 1,2
 3,4
 1,3,4
 4,6,7,9,11,12
 63
(6 rows)

select c1 from ins_test_set where c1 in (select c_set from source_tab);
 c1  
-----
 1,2
 1,2
(2 rows)

select c1 from ins_test_set a where exists (select 1 from source_tab b where b.c_set = a.c1);
 c1  
-----
 1,2
 1,2
(2 rows)

select c1 from ins_test_set where c1 not in (select c_set from source_tab) order by 1;
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1,2,3,64
 1
 1
 3,4
 3,4
 3,4
 3,4
 1,3,4
 1,3,4
 4,6,7,9,11,12
 4,6,7,9,11,12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 63
 63
(20 rows)

select distinct c1 from ins_test_set where c1 not in (select c_set from source_tab) order by 1;
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1,2,3,64
 1
 3,4
 1,3,4
 4,6,7,9,11,12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 63
(7 rows)

select distinct c1 from ins_test_set a where not exists (select 1 from source_tab b where b.c_set = a.c1) order by 1;
                                                 c1                                                 
----------------------------------------------------------------------------------------------------
 1,2,3,64
 1
 3,4
 1,3,4
 4,6,7,9,11,12
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62
 63
(7 rows)

select distinct c1 from ins_test_set where c1=any(select c_set from source_tab);
 c1  
-----
 1,2
(1 row)

select distinct c1 from ins_test_set where c1=any(select c_bool from source_tab);
 c1 
----
 1
(1 row)

select distinct c1 from ins_test_set where c1=any(select c_int8 from source_tab);
 c1 
----
 63
(1 row)

select distinct c1 from ins_test_set where c1=all(select c_set from source_tab);
 c1  
-----
 1,2
(1 row)

select distinct c1 from ins_test_set where c1=all(select c_bool from source_tab);
 c1 
----
 1
(1 row)

select distinct c1 from ins_test_set where c1=all(select c_int8 from source_tab);
 c1 
----
 63
(1 row)

-- aggr function: sum/max/min/avg/count/median/array_agg/string_agg/listagg/bit_and/bit_or
select array_agg(c1) from ins_test_set; -- fail, not support
ERROR:  could not find range type for data type ins_test_set_c1_set
CONTEXT:  referenced column: array_agg
select array_agg(c1) from (select distinct c1::int8 as c1 from ins_test_set order by c1);
                                   array_agg                                   
-------------------------------------------------------------------------------
 {-9223372036854775801,1,3,12,13,3432,4611606018427387904,4611686018427387904}
(1 row)

select sum(c1), max(c1+1), min(c1-1), avg(c1), count(c1), median(c1) from ins_test_set;
          sum          |         max         |         min          |         avg          | count | median 
-----------------------+---------------------+----------------------+----------------------+-------+--------
 -36893648147419096244 | 4611686018427387905 | -9223372036854775802 | -1676984006700868011 |    22 |     12
(1 row)

select string_agg(c1, '->' order by c1) from ins_test_set; -- order by string, result is also string format
                                                                                                                                                                         string_agg                                                                                                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 1->1->1,2->1,2->1,2,3,64->1,2,3,64->1,2,3,64->1,2,3,64->1,2,3,64->1,2,3,64->1,3,4->1,3,4->17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62->17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62->3,4->3,4->3,4->3,4->4,6,7,9,11,12->4,6,7,9,11,12->63->63
(1 row)

select listagg(c1, '->') within group(order by c1) from ins_test_set; -- order by set value, and the result is set values
                                                                                                                                listagg                                                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 -9223372036854775801->-9223372036854775801->-9223372036854775801->-9223372036854775801->-9223372036854775801->-9223372036854775801->1->1->3->3->12->12->12->12->13->13->3432->3432->4611606018427387904->4611606018427387904->4611686018427387904->4611686018427387904
(1 row)

select listagg(c1, '->') within group(order by c1) over (partition by c2) from ins_test_set;
                                        listagg                                         
----------------------------------------------------------------------------------------
 3432->3432
 3432->3432
 3->3
 3->3
 12->12
 12->12
 -9223372036854775801->-9223372036854775801->12->12
 -9223372036854775801->-9223372036854775801->12->12
 -9223372036854775801->-9223372036854775801->12->12
 -9223372036854775801->-9223372036854775801->12->12
 13->13
 13->13
 1->1
 1->1
 -9223372036854775801->-9223372036854775801->-9223372036854775801->-9223372036854775801
 -9223372036854775801->-9223372036854775801->-9223372036854775801->-9223372036854775801
 -9223372036854775801->-9223372036854775801->-9223372036854775801->-9223372036854775801
 -9223372036854775801->-9223372036854775801->-9223372036854775801->-9223372036854775801
 4611606018427387904->4611606018427387904->4611686018427387904->4611686018427387904
 4611606018427387904->4611606018427387904->4611686018427387904->4611686018427387904
 4611606018427387904->4611606018427387904->4611686018427387904->4611686018427387904
 4611606018427387904->4611606018427387904->4611686018427387904->4611686018427387904
(22 rows)

select c2, listagg(c1, '->') within group(order by c1) over (partition by c2) from ins_test_set order by c2;
                                                 c2                                                 |                                        listagg                                         
----------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------
 1                                                                                                  | 3432->3432
 1                                                                                                  | 3432->3432
 1,2                                                                                                | 3->3
 1,2                                                                                                | 3->3
 1,2,3                                                                                              | 12->12
 1,2,3                                                                                              | 12->12
 3,4                                                                                                | -9223372036854775801->-9223372036854775801->12->12
 3,4                                                                                                | -9223372036854775801->-9223372036854775801->12->12
 3,4                                                                                                | -9223372036854775801->-9223372036854775801->12->12
 3,4                                                                                                | -9223372036854775801->-9223372036854775801->12->12
 4,6,7,9,11,12                                                                                      | 13->13
 4,6,7,9,11,12                                                                                      | 13->13
 62                                                                                                 | 1->1
 62                                                                                                 | 1->1
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | -9223372036854775801->-9223372036854775801->-9223372036854775801->-9223372036854775801
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | -9223372036854775801->-9223372036854775801->-9223372036854775801->-9223372036854775801
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | -9223372036854775801->-9223372036854775801->-9223372036854775801->-9223372036854775801
 17,18,20,22,23,27,28,32,33,35,36,37,38,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62 | -9223372036854775801->-9223372036854775801->-9223372036854775801->-9223372036854775801
 63                                                                                                 | 4611606018427387904->4611606018427387904->4611686018427387904->4611686018427387904
 63                                                                                                 | 4611606018427387904->4611606018427387904->4611686018427387904->4611686018427387904
 63                                                                                                 | 4611606018427387904->4611606018427387904->4611686018427387904->4611686018427387904
 63                                                                                                 | 4611606018427387904->4611606018427387904->4611686018427387904->4611686018427387904
(22 rows)

select bit_and(c1) from ins_test_set group by c2 having bit_and(c1) > 0 order by 1;
 bit_and 
---------
       1
       3
       4
      12
      13
    3432
(6 rows)

select bit_or(c1) from ins_test_set group by c2 having bit_or(c1) > 0 order by 1;
       bit_or        
---------------------
                   1
                   3
                  12
                  13
                3432
 9223292036854775808
(6 rows)

-- update test
update ins_test_set set c1 = 0 where c1=-9223372036854775801 returning c1;
 c1 
----
 
 
 
 
 
 
(6 rows)

update ins_test_set set c1 = -1 where c1='1' returning c1+1;
 ?column? 
----------
        0
        0
(2 rows)

update ins_test_set set c1 = 9223372036854775808 where c1=3; -- fail, out of range
ERROR:  bigint out of range
CONTEXT:  referenced column: c1
update ins_test_set set c1 = -9223372036854775808 where c1=3 returning to_char(c1);
 to_char 
---------
 64
 64
(2 rows)

update ins_test_set set c1 = 9223372036854775807 where c1='3,4' returning (c1::bigint % 10) / 16;
 ?column? 
----------
    .4375
    .4375
    .4375
    .4375
(4 rows)

update ins_test_set set c1 = '65'; -- fail
ERROR:  invalid input value for set ins_test_set_c1_set: '65'
LINE 1: update ins_test_set set c1 = '65';
                                     ^
CONTEXT:  referenced column: c1
update ins_test_set set c1 = '1,64' where c1='1,3,4' returning (c1-1);
       ?column?       
----------------------
 -9223372036854775808
 -9223372036854775808
(2 rows)

update ins_test_set set c1 = '63' where c1=3432.49 returning c1 * 0.01; -- update 0
 ?column? 
----------
(0 rows)

update ins_test_set set c1 = '63' where c1=3432 returning c1 * 0.01; -- update 2
       ?column?       
----------------------
 46116860184273879.04
 46116860184273879.04
(2 rows)

update ins_test_set set c1 = true::int where c1 = 9223372036854775808; -- update 0
update ins_test_set set c1 = false::int where c1 = 9223372036854775807; -- update 4
update ins_test_set set c1 = 1.23 where c1 = '63';
update ins_test_set set c1 = '6,6,6' where c1 = -1 or c1 = '64';
update ins_test_set set c1 = -9223372036854775809 where c1 = 1;
ERROR:  bigint out of range
CONTEXT:  referenced column: c1
update ins_test_set set c1 = (select c_float8 from source_tab) where c1 = 1;
update ins_test_set set c1 = (select c_nvarchar2 from source_tab) where c1 = (select c_float8 from source_tab);
select c1::bigint as num, c1 from ins_test_set order by c1;
         num          |    c1    
----------------------+----------
 -9223372036854775807 | 1,64
 -9223372036854775807 | 1,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
 -9223372036854775801 | 1,2,3,64
                    0 | 
                    0 | 
                    0 | 
                    0 | 
                    0 | 
                    0 | 
                    0 | 
                    0 | 
                    0 | 
                    0 | 
                   32 | 6
                   32 | 6
                   32 | 6
                   32 | 6
(22 rows)

-- delete test
delete from ins_test_set where c1 > '1,2,3,64' returning c1::bigint;
          c1          
----------------------
 -9223372036854775807
 -9223372036854775807
                   32
                   32
                   32
                   32
(6 rows)

delete from ins_test_set where c1 = -9223372036854775807 returning -c1::bigint;
 ?column? 
----------
(0 rows)

delete from ins_test_set where c1 = (select 0);
delete from ins_test_set where c1 = 32.156; -- 0 row
delete from ins_test_set where c1 = 32 returning *; -- 0 row
 c1 | c2 | c3 
----+----+----
(0 rows)

-- index scan test
create index idx_test_c1 on ins_test_set (c1);
select * from ins_test_set where c1=-9223372036854775801 order by c2, c3;
    c1    | c2 | c3 
----------+----+----
 1,2,3,64 | 1  | 
 1,2,3,64 | 1  | 
 1,2,3,64 | 63 | 
 1,2,3,64 | 63 | 
 1,2,3,64 | 63 | 
 1,2,3,64 | 63 | 
(6 rows)

select * from ins_test_set where c1='1,2,3,64' order by c2, c3;
    c1    | c2 | c3 
----------+----+----
 1,2,3,64 | 1  | 
 1,2,3,64 | 1  | 
 1,2,3,64 | 63 | 
 1,2,3,64 | 63 | 
 1,2,3,64 | 63 | 
 1,2,3,64 | 63 | 
(6 rows)

select c1, c2 from ins_test_set a, source_tab b where a.c1 = b.c_set order by 1,2;
 c1 | c2 
----+----
(0 rows)

set enable_hashjoin=off;
select c1, c2 from ins_test_set a, source_tab b where a.c1 = b.c_set order by 1,2;
 c1 | c2 
----+----
(0 rows)

set enable_mergejoin=off;
select c1, c2 from ins_test_set a, source_tab b where a.c1 = b.c_set order by 1,2;
 c1 | c2 
----+----
(0 rows)

select c1, c2 from ins_test_set a, source_tab b where a.c1 = b.c_int8;
 c1 | c2 
----+----
(0 rows)

set enable_hashjoin=on;
set enable_mergejoin=on;
select c1, c2 from ins_test_set a, source_tab b where a.c1 = b.c_float4; -- no index scan
 c1 | c2 
----+----
(0 rows)

select c1, c2 from ins_test_set a, source_tab b where a.c1 = b.c_numberic; -- no index scan
 c1 | c2 
----+----
(0 rows)

select c1, c2 from ins_test_set a, source_tab b where a.c1 = b.c_text order by c2; -- no index scan
    c1    | c2 
----------+----
 1,2,3,64 | 1
 1,2,3,64 | 1
 1,2,3,64 | 63
 1,2,3,64 | 63
 1,2,3,64 | 63
 1,2,3,64 | 63
(6 rows)

set enable_seqscan = off;
explain (costs off) select c2 from ins_test_set where c1 = 3 order by c1; -- eliminate sort by index
                  QUERY PLAN                  
----------------------------------------------
 [Bypass]
 Index Scan using idx_test_c1 on ins_test_set
   Index Cond: (c1 = 3)
(3 rows)

-- hash index is not supportted for row store
create index idx_test_c2 on ins_test_set using hash (c2);
-- test find_in_set()
select c1, find_in_set(null, c1) from ins_test_set order by 1,2;
    c1    | find_in_set 
----------+-------------
 1,2,3,64 |            
 1,2,3,64 |            
 1,2,3,64 |            
 1,2,3,64 |            
 1,2,3,64 |            
 1,2,3,64 |            
(6 rows)

select c1, find_in_set(3, null) from ins_test_set order by 1,2;
    c1    | find_in_set 
----------+-------------
 1,2,3,64 |            
 1,2,3,64 |            
 1,2,3,64 |            
 1,2,3,64 |            
 1,2,3,64 |            
 1,2,3,64 |            
(6 rows)

select c1, find_in_set(',', c1) from ins_test_set order by 1,2;
    c1    | find_in_set 
----------+-------------
 1,2,3,64 |           0
 1,2,3,64 |           0
 1,2,3,64 |           0
 1,2,3,64 |           0
 1,2,3,64 |           0
 1,2,3,64 |           0
(6 rows)

select c1, find_in_set('a,b', c1) from ins_test_set order by 1,2;
    c1    | find_in_set 
----------+-------------
 1,2,3,64 |           0
 1,2,3,64 |           0
 1,2,3,64 |           0
 1,2,3,64 |           0
 1,2,3,64 |           0
 1,2,3,64 |           0
(6 rows)

select c1, find_in_set('3', c1) from ins_test_set order by 1,2;
    c1    | find_in_set 
----------+-------------
 1,2,3,64 |           3
 1,2,3,64 |           3
 1,2,3,64 |           3
 1,2,3,64 |           3
 1,2,3,64 |           3
 1,2,3,64 |           3
(6 rows)

select c1, find_in_set(3, c1) from ins_test_set order by 1,2;
    c1    | find_in_set 
----------+-------------
 1,2,3,64 |           3
 1,2,3,64 |           3
 1,2,3,64 |           3
 1,2,3,64 |           3
 1,2,3,64 |           3
 1,2,3,64 |           3
(6 rows)

-- test compare rules for set
drop table if exists test1;
NOTICE:  table "test1" does not exist, skipping
create table test1 (c set('d','c','b','a'));
NOTICE:  CREATE TABLE will create implicit set "test1_c_set" for column "test1.c"
insert into test1 values ('a'),('b'),('c'),('d');
select c, c+0 from test1 order by c; -- order by value
 c | ?column? 
---+----------
 d |        1
 c |        2
 b |        4
 a |        8
(4 rows)

drop table if exists test1;
drop table if exists test2;
NOTICE:  table "test2" does not exist, skipping
create table test1 (c set('a','b','c','d'));
NOTICE:  CREATE TABLE will create implicit set "test1_c_set" for column "test1.c"
insert into test1 values ('a'),('b'),('c'),('d');
create table test2 (c set('d','c','b','a'));
NOTICE:  CREATE TABLE will create implicit set "test2_c_set" for column "test2.c"
insert into test2 values ('a'),('b'),('c'),('d');
select test1.c + 0, test1.c as c1, test2.c + 0, test2.c as c2, test1.c > test2.c from test1, test2 where test1.c > test2.c order by 1,3;
 ?column? | c1 | ?column? | c2 | ?column? 
----------+----+----------+----+----------
        2 | b  |        8 | a  | t
        4 | c  |        4 | b  | t
        4 | c  |        8 | a  | t
        8 | d  |        2 | c  | t
        8 | d  |        4 | b  | t
        8 | d  |        8 | a  | t
(6 rows)

select test1.c + 0, test1.c as c1, test2.c + 0, test2.c as c2, test1.c > test2.c from test1, test2 where test1.c >= test2.c order by 1,3;
 ?column? | c1 | ?column? | c2 | ?column? 
----------+----+----------+----+----------
        1 | a  |        8 | a  | f
        2 | b  |        4 | b  | f
        2 | b  |        8 | a  | t
        4 | c  |        2 | c  | f
        4 | c  |        4 | b  | t
        4 | c  |        8 | a  | t
        8 | d  |        1 | d  | f
        8 | d  |        2 | c  | t
        8 | d  |        4 | b  | t
        8 | d  |        8 | a  | t
(10 rows)

select test1.c + 0, test1.c as c1, test2.c + 0, test2.c as c2, test1.c > test2.c from test1, test2 where test1.c < test2.c order by 1,3;
 ?column? | c1 | ?column? | c2 | ?column? 
----------+----+----------+----+----------
        1 | a  |        1 | d  | f
        1 | a  |        2 | c  | f
        1 | a  |        4 | b  | f
        2 | b  |        1 | d  | f
        2 | b  |        2 | c  | f
        4 | c  |        1 | d  | f
(6 rows)

select test1.c + 0, test1.c as c1, test2.c + 0, test2.c as c2, test1.c > test2.c from test1, test2 where test1.c <= test2.c order by 1,3;
 ?column? | c1 | ?column? | c2 | ?column? 
----------+----+----------+----+----------
        1 | a  |        1 | d  | f
        1 | a  |        2 | c  | f
        1 | a  |        4 | b  | f
        1 | a  |        8 | a  | f
        2 | b  |        1 | d  | f
        2 | b  |        2 | c  | f
        2 | b  |        4 | b  | f
        4 | c  |        1 | d  | f
        4 | c  |        2 | c  | f
        8 | d  |        1 | d  | f
(10 rows)

select test1.c + 0, test1.c as c1, test2.c + 0, test2.c as c2, test1.c > test2.c from test1, test2 where test1.c != test2.c order by 1,3;
 ?column? | c1 | ?column? | c2 | ?column? 
----------+----+----------+----+----------
        1 | a  |        1 | d  | f
        1 | a  |        2 | c  | f
        1 | a  |        4 | b  | f
        2 | b  |        1 | d  | f
        2 | b  |        2 | c  | f
        2 | b  |        8 | a  | t
        4 | c  |        1 | d  | f
        4 | c  |        4 | b  | t
        4 | c  |        8 | a  | t
        8 | d  |        2 | c  | t
        8 | d  |        4 | b  | t
        8 | d  |        8 | a  | t
(12 rows)

select test1.c + 0, test1.c as c1, test2.c + 0, test2.c as c2, test1.c > test2.c from test1, test2 where test1.c = test2.c order by 1,3;
 ?column? | c1 | ?column? | c2 | ?column? 
----------+----+----------+----+----------
        1 | a  |        8 | a  | f
        2 | b  |        4 | b  | f
        4 | c  |        2 | c  | f
        8 | d  |        1 | d  | f
(4 rows)

drop table if exists test1;
create table test1 (c1 set('a','b','c','d'), c2 set('d','c','b','a'));
NOTICE:  CREATE TABLE will create implicit set "test1_c1_set" for column "test1.c1"
NOTICE:  CREATE TABLE will create implicit set "test1_c2_set" for column "test1.c2"
insert into test1 values ('a', 'a'), ('b', 'b'),('c', 'c'),('d', 'd');
select test1.c1+0, test1.c1, test1.c2+0, test1.c2 from test1 where test1.c1 > test1.c2;
 ?column? | c1 | ?column? | c2 
----------+----+----------+----
(0 rows)

select test1.c1+0, test1.c1, test1.c2+0, test1.c2 from test1 where test1.c1 >= test1.c2;
 ?column? | c1 | ?column? | c2 
----------+----+----------+----
        1 | a  |        8 | a
        2 | b  |        4 | b
        4 | c  |        2 | c
        8 | d  |        1 | d
(4 rows)

select test1.c1+0, test1.c1, test1.c2+0, test1.c2 from test1 where test1.c1 < test1.c2;
 ?column? | c1 | ?column? | c2 
----------+----+----------+----
(0 rows)

select test1.c1+0, test1.c1, test1.c2+0, test1.c2 from test1 where test1.c1 <= test1.c2;
 ?column? | c1 | ?column? | c2 
----------+----+----------+----
        1 | a  |        8 | a
        2 | b  |        4 | b
        4 | c  |        2 | c
        8 | d  |        1 | d
(4 rows)

select test1.c1+0, test1.c1, test1.c2+0, test1.c2 from test1 where test1.c1 != test1.c2;
 ?column? | c1 | ?column? | c2 
----------+----+----------+----
(0 rows)

select test1.c1+0, test1.c1, test1.c2+0, test1.c2 from test1 where test1.c1 = test1.c2;
 ?column? | c1 | ?column? | c2 
----------+----+----------+----
        1 | a  |        8 | a
        2 | b  |        4 | b
        4 | c  |        2 | c
        8 | d  |        1 | d
(4 rows)

select t1.c1+0, t1.c1, t2.c2+0, t2.c2 from test1 as t1, test1 as t2 where t1.c1 > t2.c2 order by 1,3;
 ?column? | c1 | ?column? | c2 
----------+----+----------+----
        2 | b  |        8 | a
        4 | c  |        4 | b
        4 | c  |        8 | a
        8 | d  |        2 | c
        8 | d  |        4 | b
        8 | d  |        8 | a
(6 rows)

select t1.c1+0, t1.c1, t2.c2+0, t2.c2 from test1 as t1, test1 as t2 where t1.c1 >= t2.c2 order by 1,3;
 ?column? | c1 | ?column? | c2 
----------+----+----------+----
        1 | a  |        8 | a
        2 | b  |        4 | b
        2 | b  |        8 | a
        4 | c  |        2 | c
        4 | c  |        4 | b
        4 | c  |        8 | a
        8 | d  |        1 | d
        8 | d  |        2 | c
        8 | d  |        4 | b
        8 | d  |        8 | a
(10 rows)

select t1.c1+0, t1.c1, t2.c2+0, t2.c2 from test1 as t1, test1 as t2 where t1.c1 < t2.c2 order by 1,3;
 ?column? | c1 | ?column? | c2 
----------+----+----------+----
        1 | a  |        1 | d
        1 | a  |        2 | c
        1 | a  |        4 | b
        2 | b  |        1 | d
        2 | b  |        2 | c
        4 | c  |        1 | d
(6 rows)

select t1.c1+0, t1.c1, t2.c2+0, t2.c2 from test1 as t1, test1 as t2 where t1.c1 <= t2.c2 order by 1,3;
 ?column? | c1 | ?column? | c2 
----------+----+----------+----
        1 | a  |        1 | d
        1 | a  |        2 | c
        1 | a  |        4 | b
        1 | a  |        8 | a
        2 | b  |        1 | d
        2 | b  |        2 | c
        2 | b  |        4 | b
        4 | c  |        1 | d
        4 | c  |        2 | c
        8 | d  |        1 | d
(10 rows)

select t1.c1+0, t1.c1, t2.c2+0, t2.c2 from test1 as t1, test1 as t2 where t1.c1 != t2.c2 order by 1,3;
 ?column? | c1 | ?column? | c2 
----------+----+----------+----
        1 | a  |        1 | d
        1 | a  |        2 | c
        1 | a  |        4 | b
        2 | b  |        1 | d
        2 | b  |        2 | c
        2 | b  |        8 | a
        4 | c  |        1 | d
        4 | c  |        4 | b
        4 | c  |        8 | a
        8 | d  |        2 | c
        8 | d  |        4 | b
        8 | d  |        8 | a
(12 rows)

select t1.c1+0, t1.c1, t2.c2+0, t2.c2 from test1 as t1, test1 as t2 where t1.c1 = t2.c2 order by 1,3;
 ?column? | c1 | ?column? | c2 
----------+----+----------+----
        1 | a  |        8 | a
        2 | b  |        4 | b
        4 | c  |        2 | c
        8 | d  |        1 | d
(4 rows)

drop table if exists t1;
NOTICE:  table "t1" does not exist, skipping
drop table if exists t2;
NOTICE:  table "t2" does not exist, skipping
create table t1 (c1 set('a', 'b'));
NOTICE:  CREATE TABLE will create implicit set "t1_c1_set" for column "t1.c1"
create table t2 (c1 set('c', 'd'));
NOTICE:  CREATE TABLE will create implicit set "t2_c1_set" for column "t2.c1"
insert into t1 values ('b');
insert into t2 values ('d'); 
select * from t1 join t2 on t1.c1 = t2.c1;  -- hash by string
 c1 | c1 
----+----
(0 rows)

explain (costs off) select * from t1 join t2 on t1.c1 = t2.c1;
           QUERY PLAN           
--------------------------------
 Nested Loop
   Join Filter: (t1.c1 = t2.c1)
   ->  Seq Scan on t1
   ->  Materialize
         ->  Seq Scan on t2
(5 rows)

set enable_hashjoin = off;
select * from t1 join t2 on t1.c1 = t2.c1;  -- sort merge join, compare by string
 c1 | c1 
----+----
(0 rows)

set enable_mergejoin = off;
explain (costs off) select * from t1 join t2 on t1.c1 = t2.c1; -- nest loop, compare by string
           QUERY PLAN           
--------------------------------
 Nested Loop
   Join Filter: (t1.c1 = t2.c1)
   ->  Seq Scan on t1
   ->  Materialize
         ->  Seq Scan on t2
(5 rows)

select * from t1 join t2 on t1.c1 = t2.c1;
 c1 | c1 
----+----
(0 rows)

select * from t1 join t2 on t1.c1 != t2.c1;
 c1 | c1 
----+----
 b  | d
(1 row)

set enable_mergejoin = on;
select * from t1 join t2 on t1.c1 != t2.c1;
 c1 | c1 
----+----
 b  | d
(1 row)

explain (costs off) select * from t1 join t2 on t1.c1 != t2.c1;
           QUERY PLAN            
---------------------------------
 Nested Loop
   Join Filter: (t1.c1 <> t2.c1)
   ->  Seq Scan on t1
   ->  Materialize
         ->  Seq Scan on t2
(5 rows)

-- set label length >= 127 select test
drop table if exists t1;
create table t1 (
  c1 set('111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111'),
  c2 set('字符串长度测试111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊')
);
NOTICE:  CREATE TABLE will create implicit set "t1_c1_set" for column "t1.c1"
NOTICE:  CREATE TABLE will create implicit set "t1_c2_set" for column "t1.c2"
insert into t1 values ('111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111', null);
insert into t1 values (1, '字符串长度测试111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊');
select c1 from t1;
                                                               c1                                                                
---------------------------------------------------------------------------------------------------------------------------------
 111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
 111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
(2 rows)

prepare sel_set1(int) as select * from t1 where c1 = $1; -- bind as int
execute sel_set1(1);
                                                               c1                                                                |                                                                                                                                                                                               c2                                                                                                                                                                                                
---------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111 | 
 111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111 | 字符串长度测试111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊
(2 rows)

prepare sel_set2(int) as select * from t1 where c2 = $1;
execute sel_set2(1);
                                                               c1                                                                |                                                                                                                                                                                               c2                                                                                                                                                                                                
---------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111 | 字符串长度测试111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊
(1 row)

prepare sel_set3 as select * from t1 where c2 = $1;
execute sel_set3('字符串长度测试111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊');
                                                               c1                                                                |                                                                                                                                                                                               c2                                                                                                                                                                                                
---------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111 | 字符串长度测试111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊
(1 row)

select find_in_set('111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111', c1),
       find_in_set('字符串长度测试111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊', c2)
  from t1;
 find_in_set | find_in_set 
-------------+-------------
           1 |            
           1 |           1
(2 rows)

drop table if exists t2;
create table t2 (
  c1 set('', '1', '111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111', '字符串长度测试111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊'),
  c2 set('1', '', '3'),
  c3 set('1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64')
);
NOTICE:  CREATE TABLE will create implicit set "t2_c1_set" for column "t2.c1"
NOTICE:  CREATE TABLE will create implicit set "t2_c2_set" for column "t2.c2"
NOTICE:  CREATE TABLE will create implicit set "t2_c3_set" for column "t2.c3"
select pg_catalog.pg_get_tabledef('t2');
                                                                                                                                                                                                                                                                      pg_get_tabledef                                                                                                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 SET search_path = public;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
 CREATE TABLE t2 (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
     c1 SET('', '1', '111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111', '字符串长度测试111111111111111111111a111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊'),+
     c2 SET('1', '', '3'),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
     c3 SET('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '50', '51', '52', '53', '54', '55', '56', '57', '58', '59', '60', '61', '62', '63', '64')                                                                                                                                                         +
 )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
 WITH (orientation=row, compression=no);
(1 row)

-- test '' as set member
-- 1. define set type not include ''
drop table if exists t1;
create table t1 (c1 set('a', 'b') not null default '');
NOTICE:  CREATE TABLE will create implicit set "t1_c1_set" for column "t1.c1"
insert into t1 values ('');
insert into t1 values (default);
select c1, c1+0 from t1; -- expect value 0
 c1 | ?column? 
----+----------
    |        0
    |        0
(2 rows)

insert into t1 values ('a,,b'); -- expect error
ERROR:  invalid input value for set t1_c1_set: ''
LINE 1: insert into t1 values ('a,,b');
                               ^
CONTEXT:  referenced column: c1
COPY t1(c1) FROM stdin WITH NULL 'NULL' CSV QUOTE '"' DELIMITER ',' ESCAPE '"';
-- 2. define set type include ''
drop table if exists t2;
create table t2 (c1 set('a', '', 'b') default '');
NOTICE:  CREATE TABLE will create implicit set "t2_c1_set" for column "t2.c1"
insert into t2 values (''); -- expect value 0, not 2
insert into t2 values (default);
select c1, c1+0 from t2;
 c1 | ?column? 
----+----------
    |        0
    |        0
(2 rows)

insert into t2 values ('a,,b'); -- expect 2, not 0
insert into t2 values (',a,b'); -- expect 2, not 0
COPY t2(c1) FROM stdin WITH NULL 'NULL' CSV QUOTE '"' DELIMITER ',' ESCAPE '"';
select c1, c1+0 from t2 order by 2;
  c1  | ?column? 
------+----------
      |        0
      |        0
      |        0
 a,,b |        7
 a,,b |        7
(5 rows)

drop table t1;
drop table t2;
-- test check duplicate set scenes
-- 1. column charset/collate
drop table if exists test_set_key1;
NOTICE:  table "test_set_key1" does not exist, skipping
create table test_set_key1(a set('', '  '));
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  duplicate key value violates unique constraint "pg_set_typid_label_index"
--?.*
create table test_set_key1(a set('', '  ') collate utf8_bin);
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  set has duplicate key value "" = "  "
create table test_set_key1(a set('a', 'a  '));
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  duplicate key value violates unique constraint "pg_set_typid_label_index"
--?.*
create table test_set_key1(a set('a', 'a  ') collate utf8_bin);
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  set has duplicate key value "a" = "a  "
create table test_set_key1(a set('aaa', 'AAA  ') collate utf8_general_ci);
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  set has duplicate key value "aaa" = "AAA  "
create table test_set_key1(a set('高斯sS', '高斯ŠŠ  ') collate utf8_general_ci);
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  set has duplicate key value "高斯sS" = "高斯ŠŠ  "
create table test_set_key1(a set('aaa', 'aaA   ') charset 'utf8');
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  set has duplicate key value "aaa" = "aaA   "
create table test_set_key1(a set('aaa', 'aaA   ') charset 'gbk');
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  set has duplicate key value "aaa" = "aaA   "
create table test_set_key1(a set('aaa', 'aaA   ') charset 'gb18030');
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  set has duplicate key value "aaa" = "aaA   "
--succeed scenes
create table t_column_collation1(a set('a', 'b', 'A','B') collate utf8_bin);
NOTICE:  CREATE TABLE will create implicit set "t_column_collation1_a_set" for column "t_column_collation1.a"
create table t_column_collation2(a set('a', 'b', 'A','B') collate utf8_bin);
NOTICE:  CREATE TABLE will create implicit set "t_column_collation2_a_set" for column "t_column_collation2.a"
create table t_column_collation3(a set('aaa', 'bbb') charset 'utf8');
NOTICE:  CREATE TABLE will create implicit set "t_column_collation3_a_set" for column "t_column_collation3.a"
create table t_column_collation4(a set('a', 'b', 'A','B') collate utf8_bin);
NOTICE:  CREATE TABLE will create implicit set "t_column_collation4_a_set" for column "t_column_collation4.a"
create table t_column_collation5(a set('高斯DB','1') character set utf8mb4 collate utf8mb4_general_ci default '高斯db');
NOTICE:  CREATE TABLE will create implicit set "t_column_collation5_a_set" for column "t_column_collation5.a"
drop table t_column_collation1;
drop table t_column_collation2;
drop table t_column_collation3;
drop table t_column_collation4;
drop table t_column_collation5;
-- 2. table charset/collate
create table test_set_key1(a set('aaa', 'aaA   ')) charset 'utf8';
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  set has duplicate key value "aaa" = "aaA   "
create table test_set_key1(a set('aaa', 'aaA   ')) collate 'utf8_general_ci';
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  set has duplicate key value "aaa" = "aaA   "
create table test_set_key1(a set('aaa', 'aaA   ')) charset 'gbk';
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  set has duplicate key value "aaa" = "aaA   "
create table test_set_key1(a set('aaa', 'aaa   ')) charset 'gbk' collate gbk_bin;
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  set has duplicate key value "aaa" = "aaa   "
create table test_set_key1(a set('aaa', 'aaA   ')) charset 'gb18030';
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  set has duplicate key value "aaa" = "aaA   "
create table test_set_key1(a set('aaa', 'aaa   ')) charset 'gb18030' collate gb18030_bin;
NOTICE:  CREATE TABLE will create implicit set "test_set_key1_a_set" for column "test_set_key1.a"
ERROR:  set has duplicate key value "aaa" = "aaa   "
--succeed scenes
create table t_table_collation1(a set('aaa', 'bbb')) charset 'utf8';
NOTICE:  CREATE TABLE will create implicit set "t_table_collation1_a_set" for column "t_table_collation1.a"
create table t_table_collation2(a set('aaa', 'aaA   ') collate 'utf8_bin')charset 'utf8';
NOTICE:  CREATE TABLE will create implicit set "t_table_collation2_a_set" for column "t_table_collation2.a"
drop table t_table_collation1;
drop table t_table_collation2;
-- 3. schema charset/collate
create schema set_test_schema1  charset = utf8;
set current_schema='set_test_schema1';
create table t(a set('a', 'A'));  --fail
NOTICE:  CREATE TABLE will create implicit set "t_a_set" for column "t.a"
ERROR:  set has duplicate key value "a" = "A"
create table t(a set('a', 'b'));  -- succeed
NOTICE:  CREATE TABLE will create implicit set "t_a_set" for column "t.a"
alter table t add column b set('a', 'A', 'b'); -- fail
NOTICE:  ALTER TABLE will create implicit set "t_b_set" for column "t.b"
ERROR:  set has duplicate key value "a" = "A"
alter table t add column b set('a', 'A', 'b') collate utf8_bin; --succeed
NOTICE:  ALTER TABLE will create implicit set "t_b_set" for column "t.b"
insert into t values('a  ', 'a  ');
insert into t values('a  ', 'A  ');
insert into t values('B  ', 'A  ');
insert into t values('a  ', 'B  ');  --fail
ERROR:  invalid input value for set t_b_set: 'B  '
LINE 1: insert into t values('a  ', 'B  ');
                                    ^
CONTEXT:  referenced column: b
drop table t;
create schema set_test_schema2  charset = utf8mb4 collate = utf8mb4_bin;
set current_schema='set_test_schema2';
create table t(a set('a', 'A'));  -- succeed
NOTICE:  CREATE TABLE will create implicit set "t_a_set" for column "t.a"
alter table t add column b set('a', 'A', 'b') collate utf8_general_ci; --fail
NOTICE:  ALTER TABLE will create implicit set "t_b_set" for column "t.b"
ERROR:  set has duplicate key value "a" = "A"
alter table t add column b set('a', 'A', 'b'); -- succeed
NOTICE:  ALTER TABLE will create implicit set "t_b_set" for column "t.b"
insert into t values ('a  ', 'b  ');
insert into t values ('a  ', 'B  '); -- fail
ERROR:  invalid input value for set t_b_set: 'B  '
LINE 1: insert into t values ('a  ', 'B  ');
                                     ^
CONTEXT:  referenced column: b
drop table t;
drop schema set_test_schema1;
drop schema set_test_schema2;
\c test
SET b_format_behavior_compat_options = 'enable_multi_charset';
-- test insert value with collation
-- 1. insert value length ignore end space
create table test_set_len (col SET('ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd') collate utf8_bin);
NOTICE:  CREATE TABLE will create implicit set "test_set_len_col_set" for column "test_set_len.col"
insert into test_set_len values ('ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd                     ');
drop table test_set_len;
-- 2. insert value while collate is binary
-- 3. insert value while collate like _bin
create table test_collation2(a set('aaa', 'AAA','高斯SS', '高斯ss') collate utf8_bin);
NOTICE:  CREATE TABLE will create implicit set "test_collation2_a_set" for column "test_collation2.a"
insert into test_collation2 values('aaa  ');
insert into test_collation2 values('aaa');
insert into test_collation2 values('AAA');
insert into test_collation2 values('AAA  ');
insert into test_collation2 values('高斯ss   ');
insert into test_collation2 values('高斯SS   ');
insert into test_collation2 values('高斯sS   '); --failed
ERROR:  invalid input value for set test_collation2_a_set: '高斯sS   '
LINE 1: insert into test_collation2 values('高斯sS   ');
                                           ^
CONTEXT:  referenced column: a
insert into test_collation2 values('高斯ss,高斯ss   ');
-- 4. insert value while collate like _ci
create table test_collation3(a set('高斯sS', '汉字sS', 'aaa', 'bbb')) charset utf8;
NOTICE:  CREATE TABLE will create implicit set "test_collation3_a_set" for column "test_collation3.a"
select pg_get_tabledef('test_collation3');
                                       pg_get_tabledef                                       
---------------------------------------------------------------------------------------------
 SET search_path = public;                                                                  +
 CREATE TABLE test_collation3 (                                                             +
     a SET('高斯sS', '汉字sS', 'aaa', 'bbb') CHARACTER SET "UTF8" COLLATE utf8mb4_general_ci+
 )                                                                                          +
 CHARACTER SET = "UTF8" COLLATE = "utf8mb4_general_ci"                                      +
 WITH (orientation=row, compression=no);
(1 row)

insert into test_collation3 values('高斯sS   ');
insert into test_collation3 values('高斯ss,高斯ss   ');
insert into test_collation3 values('高斯ŠŠ');
insert into test_collation3 values('汉字sS   ');
insert into test_collation3 values('汉字ss,汉字ss   ');
insert into test_collation3 values('汉字ŠŠ');
insert into test_collation3 values('aaa  ');
insert into test_collation3 values('aaa');
insert into test_collation3 values('AAA  ');
-- test update with colalte
create table test_update(a set('a', 'A', 'b'))collate utf8_bin;
NOTICE:  CREATE TABLE will create implicit set "test_update_a_set" for column "test_update.a"
insert into test_update values('a'),('A');
update test_update set a = 'b' where a = 'a';
update test_update set a = 'b' where a = 'a' collate utf8_general_ci;
select * from test_update;
 a 
---
 b
 b
(2 rows)

update test_update set a = 'a' where a = 'B' collate utf8_general_ci;
select * from test_update;
 a 
---
 a
 a
(2 rows)

drop table test_update;
-- test operator
create table test_collation_op(a set('a', 'A', 'b', 'B'), b set('a', 'A', 'b', 'B')) collate utf8_bin;
NOTICE:  CREATE TABLE will create implicit set "test_collation_op_a_set" for column "test_collation_op.a"
NOTICE:  CREATE TABLE will create implicit set "test_collation_op_b_set" for column "test_collation_op.b"
insert into test_collation_op values('a', 'A'),('A','a'),('b','B'),('B','b');
-- test '='
select a from test_collation2 where a = 'aaa';
  a  
-----
 aaa
 aaa
(2 rows)

select a from test_collation2 where a = '高斯ss' collate utf8_bin;
   a    
--------
 高斯ss
 高斯ss
(2 rows)

select a from test_collation2 where a = 'aaa' collate "utf8_general_ci"; -- set = text
  a  
-----
 aaa
 aaa
 AAA
 AAA
(4 rows)

select a from test_collation2 where a = '高斯ss' collate utf8_general_ci;
   a    
--------
 高斯ss
 高斯SS
 高斯ss
(3 rows)

select a from test_collation3 where a = '高斯ss';
   a    
--------
 高斯sS
 高斯sS
 高斯sS
(3 rows)

select a from test_collation3 where a = '高斯ss' collate utf8_bin;
 a 
---
(0 rows)

select a from test_collation3 where a = 'aaa' collate "utf8_general_ci";
  a  
-----
 aaa
 aaa
 aaa
(3 rows)

select a from test_collation2 where 'aaa' = a collate "utf8_general_ci"; -- text = set
  a  
-----
 aaa
 aaa
 AAA
 AAA
(4 rows)

select
  distinct t2.a, t3.a 
from
  test_collation2 as t2,
  test_collation2 as t3
where t2.a = t3.a  collate "utf8_general_ci"; -- set = set
   a    |   a    
--------+--------
 高斯SS | 高斯SS
 aaa    | AAA
 aaa    | aaa
 高斯ss | 高斯ss
 AAA    | AAA
 高斯ss | 高斯SS
 AAA    | aaa
 高斯SS | 高斯ss
(8 rows)

select
  distinct t2.a, t3.a 
from
  test_collation2 as t2,
  test_collation2 as t3
where t2.a = t3.a order by 1;
   a    |   a    
--------+--------
 AAA    | AAA
 aaa    | aaa
 高斯SS | 高斯SS
 高斯ss | 高斯ss
(4 rows)

-- '<>'
select a, b from test_collation_op where a <> b; -- set <> other set
 a | b 
---+---
 a | A
 A | a
 b | B
 B | b
(4 rows)

select a, b from test_collation_op where a <> b collate 'utf8_general_ci';
 a | b 
---+---
(0 rows)

select a, b from test_collation_op where a <> 'a'; -- set <> text
 a | b 
---+---
 A | a
 b | B
 B | b
(3 rows)

select a, b from test_collation_op where a <> 'a' collate 'utf8_general_ci';
 a | b 
---+---
 b | B
 B | b
(2 rows)

select a, b from test_collation_op where 'a' <> a;
 a | b 
---+---
 A | a
 b | B
 B | b
(3 rows)

select a, b from test_collation_op where 'a' <> a collate 'utf8_general_ci'; -- text <> set
 a | b 
---+---
 b | B
 B | b
(2 rows)

-- '<'
select a, b from test_collation_op where a < b; -- set < other set
 a | b 
---+---
 A | a
 B | b
(2 rows)

select a from test_collation_op where a < b collate 'utf8_general_ci';
 a 
---
(0 rows)

select a from test_collation_op where a < 'C'; -- set < text
 a 
---
 A
 B
(2 rows)

select a from test_collation_op where a < 'C' collate 'utf8_general_ci';
 a 
---
 a
 A
 b
 B
(4 rows)

select a from test_collation_op where 'B' < a;
 a 
---
 a
 b
(2 rows)

select a from test_collation_op where 'B' < a collate 'utf8_general_ci';
 a 
---
(0 rows)

-- '<='
select a, b from test_collation_op where a <= b; -- set <= other set
 a | b 
---+---
 A | a
 B | b
(2 rows)

select a from test_collation_op where a <= b collate 'utf8_general_ci';
 a 
---
 a
 A
 b
 B
(4 rows)

select a from test_collation_op where a <= 'A'; -- set <= text
 a 
---
 A
(1 row)

select a from test_collation_op where a <= 'A' collate 'utf8_general_ci';
 a 
---
 a
 A
(2 rows)

select a from test_collation_op where 'B' <= a; -- text <= set
 a 
---
 a
 b
 B
(3 rows)

select a from test_collation_op where 'B' <= a collate 'utf8_general_ci';
 a 
---
 b
 B
(2 rows)

-- '>'
select a, b from test_collation_op where a > b; -- set > other set
 a | b 
---+---
 a | A
 b | B
(2 rows)

select a from test_collation_op where a > b collate 'utf8_general_ci';
 a 
---
(0 rows)

select a from test_collation_op where a > 'B'; -- set > text
 a 
---
 a
 b
(2 rows)

select a from test_collation_op where a > 'B' collate 'utf8_general_ci';
 a 
---
(0 rows)

select a from test_collation_op where 'C' > a;
 a 
---
 A
 B
(2 rows)

select a from test_collation_op where 'C' > a collate 'utf8_general_ci';
 a 
---
 a
 A
 b
 B
(4 rows)

-- '>='
select a, b from test_collation_op where a >= b; -- set >= other set
 a | b 
---+---
 a | A
 b | B
(2 rows)

select a from test_collation_op where a >= b collate 'utf8_general_ci';
 a 
---
 a
 A
 b
 B
(4 rows)

select a from test_collation_op where a >= 'B'; -- set >= text
 a 
---
 a
 b
 B
(3 rows)

select a from test_collation_op where a >= 'B' collate 'utf8_general_ci';
 a 
---
 b
 B
(2 rows)

select a from test_collation_op where 'C' >= a;
 a 
---
 A
 B
(2 rows)

select a from test_collation_op where 'C' >= a collate 'utf8_general_ci';
 a 
---
 a
 A
 b
 B
(4 rows)

-- test order by
select a from test_collation2 order by a;
   a    
--------
 AAA
 AAA
 aaa
 aaa
 高斯SS
 高斯ss
 高斯ss
(7 rows)

select a from test_collation2 order by a collate 'utf8_general_ci';
   a    
--------
 aaa
 aaa
 AAA
 AAA
 高斯ss
 高斯SS
 高斯ss
(7 rows)

select a from test_collation2 order by a collate 'utf8_bin';
   a    
--------
 AAA
 AAA
 aaa
 aaa
 高斯SS
 高斯ss
 高斯ss
(7 rows)

select a from test_collation3 order by a;
   a    
--------
 aaa
 aaa
 aaa
 汉字sS
 汉字sS
 汉字sS
 高斯sS
 高斯sS
 高斯sS
(9 rows)

select a from test_collation3 order by a collate 'utf8_general_ci';
   a    
--------
 aaa
 aaa
 aaa
 汉字sS
 汉字sS
 汉字sS
 高斯sS
 高斯sS
 高斯sS
(9 rows)

select a from test_collation3 order by a collate 'utf8_bin';
   a    
--------
 aaa
 aaa
 aaa
 汉字sS
 汉字sS
 汉字sS
 高斯sS
 高斯sS
 高斯sS
(9 rows)

-- test distinct
select distinct a from test_collation2;
   a    
--------
 高斯SS
 高斯ss
 aaa
 AAA
(4 rows)

select distinct a collate 'utf8_bin' from test_collation2;
   a    
--------
 高斯SS
 高斯ss
 aaa
 AAA
(4 rows)

select distinct a collate 'utf8_general_ci' from test_collation2;
   a    
--------
 aaa
 高斯ss
(2 rows)

select distinct a from test_collation3;
   a    
--------
 汉字sS
 aaa
 高斯sS
(3 rows)

select distinct a collate 'utf8_bin' from test_collation3;
   a    
--------
 高斯sS
 aaa
 汉字sS
(3 rows)

select distinct a collate 'utf8_general_ci' from test_collation3;
   a    
--------
 汉字sS
 aaa
 高斯sS
(3 rows)

-- test like
select a from test_collation2 where a like 'aa%';
  a  
-----
 aaa
 aaa
(2 rows)

select a from test_collation2 where a like 'aa%' collate 'utf8_general_ci';
  a  
-----
 aaa
 aaa
 AAA
 AAA
(4 rows)

select a from test_collation3 where a like 'aa%';
  a  
-----
 aaa
 aaa
 aaa
(3 rows)

select a from test_collation3 where a like 'aa%' collate 'utf8_general_ci';
  a  
-----
 aaa
 aaa
 aaa
(3 rows)

-- test alter table modify/add
alter table test_collation3 modify a char(10) collate utf8_bin;
select a from test_collation3 where a = '高斯ss';
 a 
---
(0 rows)

select a from test_collation3 where a = '高斯sS' collate utf8_bin;
    a     
----------
 高斯sS  
 高斯sS  
 高斯sS  
(3 rows)

alter table test_collation3 modify a set('高斯sS', '汉字sS', 'aaa', 'bbb');
NOTICE:  ALTER TABLE will create implicit set "test_collation3_a_set" for column "test_collation3.a"
select pg_get_tabledef('test_collation3');
                                       pg_get_tabledef                                       
---------------------------------------------------------------------------------------------
 SET search_path = public;                                                                  +
 CREATE TABLE test_collation3 (                                                             +
     a SET('高斯sS', '汉字sS', 'aaa', 'bbb') CHARACTER SET "UTF8" COLLATE utf8mb4_general_ci+
 )                                                                                          +
 CHARACTER SET = "UTF8" COLLATE = "utf8mb4_general_ci"                                      +
 WITH (orientation=row, compression=no);
(1 row)

insert into test_collation3 values('高斯ŠŠ  ');
alter table test_collation3 add b set('a','b', 'c');
NOTICE:  ALTER TABLE will create implicit set "test_collation3_b_set" for column "test_collation3.b"
insert into test_collation3(b) values('A'), ('b  '), (3);
-- test unique/primary key
create table t_collation_set5(a set('aaa', 'bbb') collate utf8_general_ci unique);
NOTICE:  CREATE TABLE will create implicit set "t_collation_set5_a_set" for column "t_collation_set5.a"
NOTICE:  CREATE TABLE / UNIQUE will create implicit index "t_collation_set5_a_key" for table "t_collation_set5"
insert into t_collation_set5 values('aaa');
insert into t_collation_set5 values('aaa  ');
ERROR:  duplicate key value violates unique constraint "t_collation_set5_a_key"
DETAIL:  Key (a)=(aaa) already exists.
insert into t_collation_set5 values('AAA  ');
ERROR:  duplicate key value violates unique constraint "t_collation_set5_a_key"
DETAIL:  Key (a)=(aaa) already exists.
create table t_collation_set6(a set('aaa', 'bbb') collate utf8_general_ci primary key);
NOTICE:  CREATE TABLE will create implicit set "t_collation_set6_a_set" for column "t_collation_set6.a"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "t_collation_set6_pkey" for table "t_collation_set6"
insert into t_collation_set6 values('aaa  ');
insert into t_collation_set6 values('aaa');
ERROR:  duplicate key value violates unique constraint "t_collation_set6_pkey"
DETAIL:  Key (a)=(aaa) already exists.
insert into t_collation_set6 values('AAA  ');
ERROR:  duplicate key value violates unique constraint "t_collation_set6_pkey"
DETAIL:  Key (a)=(aaa) already exists.
drop table t_collation_set5;
drop table t_collation_set6;
-- test join
create table test_join1(
  c_char char(10),
  c_varchar varchar(10),
  c_nvarchar2 nvarchar2(10),
  c_text text,
  c_set set('a')
) collate utf8_bin;
NOTICE:  CREATE TABLE will create implicit set "test_join1_c_set_set" for column "test_join1.c_set"
create table test_join2(
  c_set set('A')
) collate utf8_bin;
NOTICE:  CREATE TABLE will create implicit set "test_join2_c_set_set" for column "test_join2.c_set"
insert into test_join1 values('a  ', 'a  ', 'a  ', 'a  ','a  ');
insert into test_join2 values('A');
select t1.c_char, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set = t1.c_char;
 c_char | c_set 
--------+-------
(0 rows)

select t1.c_char, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set = t1.c_char collate 'utf8_general_ci';
   c_char   | c_set 
------------+-------
 a          | A
(1 row)

select t1.c_char, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <> t1.c_char;
   c_char   | c_set 
------------+-------
 a          | A
(1 row)

select t1.c_char, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <> t1.c_char collate 'utf8_general_ci';
 c_char | c_set 
--------+-------
(0 rows)

select t1.c_char, t2.c_set from test_join1 t1 join test_join2 t2 on t1.c_char > t2.c_set;
   c_char   | c_set 
------------+-------
 a          | A
(1 row)

select t1.c_char, t2.c_set from test_join1 t1 join test_join2 t2 on t1.c_char > t2.c_set collate 'utf8_general_ci';
 c_char | c_set 
--------+-------
(0 rows)

select t1.c_char, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set >= t1.c_char;
 c_char | c_set 
--------+-------
(0 rows)

select t1.c_char, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set >= t1.c_char collate 'utf8_general_ci';
   c_char   | c_set 
------------+-------
 a          | A
(1 row)

select t1.c_char, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set < t1.c_char;
   c_char   | c_set 
------------+-------
 a          | A
(1 row)

select t1.c_char, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set < t1.c_char collate 'utf8_general_ci';
 c_char | c_set 
--------+-------
(0 rows)

select t1.c_char, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <= t1.c_char;
   c_char   | c_set 
------------+-------
 a          | A
(1 row)

select t1.c_char, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <= t1.c_char collate 'utf8_general_ci';
   c_char   | c_set 
------------+-------
 a          | A
(1 row)

select t1.c_varchar, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set = t1.c_varchar;
 c_varchar | c_set 
-----------+-------
(0 rows)

select t1.c_varchar, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set = t1.c_varchar collate 'utf8_general_ci';
 c_varchar | c_set 
-----------+-------
 a         | A
(1 row)

select t1.c_varchar, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <> t1.c_varchar;
 c_varchar | c_set 
-----------+-------
 a         | A
(1 row)

select t1.c_varchar, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <> t1.c_varchar collate 'utf8_general_ci';
 c_varchar | c_set 
-----------+-------
(0 rows)

select t1.c_varchar, t2.c_set from test_join1 t1 join test_join2 t2 on t1.c_varchar > t2.c_set;
 c_varchar | c_set 
-----------+-------
 a         | A
(1 row)

select t1.c_varchar, t2.c_set from test_join1 t1 join test_join2 t2 on t1.c_varchar > t2.c_set collate 'utf8_general_ci';
 c_varchar | c_set 
-----------+-------
(0 rows)

select t1.c_varchar, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set >= t1.c_varchar;
 c_varchar | c_set 
-----------+-------
(0 rows)

select t1.c_varchar, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set >= t1.c_varchar collate 'utf8_general_ci';
 c_varchar | c_set 
-----------+-------
 a         | A
(1 row)

select t1.c_varchar, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set < t1.c_varchar;
 c_varchar | c_set 
-----------+-------
 a         | A
(1 row)

select t1.c_varchar, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set < t1.c_varchar collate 'utf8_general_ci';
 c_varchar | c_set 
-----------+-------
(0 rows)

select t1.c_varchar, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <= t1.c_varchar;
 c_varchar | c_set 
-----------+-------
 a         | A
(1 row)

select t1.c_varchar, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <= t1.c_varchar collate 'utf8_general_ci';
 c_varchar | c_set 
-----------+-------
 a         | A
(1 row)

select t1.c_nvarchar2, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set = t1.c_nvarchar2;
 c_nvarchar2 | c_set 
-------------+-------
(0 rows)

select t1.c_nvarchar2, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set = t1.c_nvarchar2 collate 'utf8_general_ci';
 c_nvarchar2 | c_set 
-------------+-------
 a           | A
(1 row)

select t1.c_nvarchar2, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <> t1.c_nvarchar2;
 c_nvarchar2 | c_set 
-------------+-------
 a           | A
(1 row)

select t1.c_nvarchar2, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <> t1.c_nvarchar2 collate 'utf8_general_ci';
 c_nvarchar2 | c_set 
-------------+-------
(0 rows)

select t1.c_nvarchar2, t2.c_set from test_join1 t1 join test_join2 t2 on t1.c_nvarchar2 > t2.c_set;
 c_nvarchar2 | c_set 
-------------+-------
 a           | A
(1 row)

select t1.c_nvarchar2, t2.c_set from test_join1 t1 join test_join2 t2 on t1.c_nvarchar2 > t2.c_set collate 'utf8_general_ci';
 c_nvarchar2 | c_set 
-------------+-------
(0 rows)

select t1.c_nvarchar2, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set >= t1.c_nvarchar2;
 c_nvarchar2 | c_set 
-------------+-------
(0 rows)

select t1.c_nvarchar2, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set >= t1.c_nvarchar2 collate 'utf8_general_ci';
 c_nvarchar2 | c_set 
-------------+-------
 a           | A
(1 row)

select t1.c_nvarchar2, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set < t1.c_nvarchar2;
 c_nvarchar2 | c_set 
-------------+-------
 a           | A
(1 row)

select t1.c_nvarchar2, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set < t1.c_nvarchar2 collate 'utf8_general_ci';
 c_nvarchar2 | c_set 
-------------+-------
(0 rows)

select t1.c_nvarchar2, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <= t1.c_nvarchar2;
 c_nvarchar2 | c_set 
-------------+-------
 a           | A
(1 row)

select t1.c_nvarchar2, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <= t1.c_nvarchar2 collate 'utf8_general_ci';
 c_nvarchar2 | c_set 
-------------+-------
 a           | A
(1 row)

select t1.c_text, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set = t1.c_text;
 c_text | c_set 
--------+-------
(0 rows)

select t1.c_text, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set = t1.c_text collate 'utf8_general_ci';
 c_text | c_set 
--------+-------
 a      | A
(1 row)

select t1.c_text, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <> t1.c_text;
 c_text | c_set 
--------+-------
 a      | A
(1 row)

select t1.c_text, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <> t1.c_text collate 'utf8_general_ci';
 c_text | c_set 
--------+-------
(0 rows)

select t1.c_text, t2.c_set from test_join1 t1 join test_join2 t2 on t1.c_text > t2.c_set;
 c_text | c_set 
--------+-------
 a      | A
(1 row)

select t1.c_text, t2.c_set from test_join1 t1 join test_join2 t2 on t1.c_text > t2.c_set collate 'utf8_general_ci';
 c_text | c_set 
--------+-------
(0 rows)

select t1.c_text, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set >= t1.c_text;
 c_text | c_set 
--------+-------
(0 rows)

select t1.c_text, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set >= t1.c_text collate 'utf8_general_ci';
 c_text | c_set 
--------+-------
 a      | A
(1 row)

select t1.c_text, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set < t1.c_text;
 c_text | c_set 
--------+-------
 a      | A
(1 row)

select t1.c_text, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set < t1.c_text collate 'utf8_general_ci';
 c_text | c_set 
--------+-------
(0 rows)

select t1.c_text, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <= t1.c_text;
 c_text | c_set 
--------+-------
 a      | A
(1 row)

select t1.c_text, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <= t1.c_text collate 'utf8_general_ci';
 c_text | c_set 
--------+-------
 a      | A
(1 row)

select t1.c_set, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set = t1.c_set;
 c_set | c_set 
-------+-------
(0 rows)

select t1.c_set, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set = t1.c_set collate 'utf8_general_ci';
 c_set | c_set 
-------+-------
 a     | A
(1 row)

select t1.c_set, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <> t1.c_set;
 c_set | c_set 
-------+-------
 a     | A
(1 row)

select t1.c_set, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <> t1.c_set collate 'utf8_general_ci';
 c_set | c_set 
-------+-------
(0 rows)

select t1.c_set, t2.c_set from test_join1 t1 join test_join2 t2 on t1.c_set > t2.c_set;
 c_set | c_set 
-------+-------
 a     | A
(1 row)

select t1.c_set, t2.c_set from test_join1 t1 join test_join2 t2 on t1.c_set > t2.c_set collate 'utf8_general_ci';
 c_set | c_set 
-------+-------
(0 rows)

select t1.c_set, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set >= t1.c_set;
 c_set | c_set 
-------+-------
(0 rows)

select t1.c_set, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set >= t1.c_set collate 'utf8_general_ci';
 c_set | c_set 
-------+-------
 a     | A
(1 row)

select t1.c_set, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set < t1.c_set;
 c_set | c_set 
-------+-------
 a     | A
(1 row)

select t1.c_set, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set < t1.c_set collate 'utf8_general_ci';
 c_set | c_set 
-------+-------
(0 rows)

select t1.c_set, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <= t1.c_set;
 c_set | c_set 
-------+-------
 a     | A
(1 row)

select t1.c_set, t2.c_set from test_join1 t1 join test_join2 t2 on t2.c_set <= t1.c_set collate 'utf8_general_ci';
 c_set | c_set 
-------+-------
 a     | A
(1 row)

drop table test_join1;
drop table test_join2;
-- test partition table with collate
create table test_part_tab1(c1 int, c2 set('a', 'b', 'A', 'B'))charset utf8 partition by range(c1)  --fail
(
    partition test_set_tab_p1 values less than (5),
    partition test_set_tab_p2 values less than (10)
);
NOTICE:  CREATE TABLE will create implicit set "test_part_tab1_c2_set" for column "test_part_tab1.c2"
ERROR:  set has duplicate key value "a" = "A"
create table test_part_tab1(c1 int, c2 set('a', 'b', 'A', 'B'))charset utf8 collate utf8_bin partition by range(c1)  -- success
(
    partition test_set_tab_p1 values less than (5),
    partition test_set_tab_p2 values less than (10)
);
NOTICE:  CREATE TABLE will create implicit set "test_part_tab1_c2_set" for column "test_part_tab1.c2"
select pg_get_tabledef('test_part_tab1');
                           pg_get_tabledef                            
----------------------------------------------------------------------
 SET search_path = public;                                           +
 CREATE TABLE test_part_tab1 (                                       +
     c1 integer,                                                     +
     c2 SET('a', 'b', 'A', 'B') CHARACTER SET "UTF8" COLLATE utf8_bin+
 )                                                                   +
 CHARACTER SET = "UTF8" COLLATE = "utf8_bin"                         +
 WITH (orientation=row, compression=no)                              +
 PARTITION BY RANGE (c1)                                             +
 (                                                                   +
     PARTITION test_set_tab_p1 VALUES LESS THAN (5),                 +
     PARTITION test_set_tab_p2 VALUES LESS THAN (10)                 +
 )                                                                   +
 ENABLE ROW MOVEMENT;
(1 row)

insert into test_part_tab1 values(1, 'a  ');
insert into test_part_tab1 values(6, 'A  ');
insert into test_part_tab1 values(2, 'b  ');
insert into test_part_tab1 values(7, 'B  ');
create table test_part_tab2(c1 int, c2 set('a', 'b', 'c', 'd'))charset utf8 partition by range(c1) -- success
(
    partition test_set_tab_p1 values less than (5),
    partition test_set_tab_p2 values less than (10)
);
NOTICE:  CREATE TABLE will create implicit set "test_part_tab2_c2_set" for column "test_part_tab2.c2"
insert into test_part_tab2 values(1, 'a  ');
insert into test_part_tab2 values(6, 'A  ');
insert into test_part_tab2 values(2, 'b  ');
insert into test_part_tab2 values(7, 'B  ');
drop table test_part_tab1;
drop table test_part_tab2;
-- test local/global temp table with collate
create local temp table test_temp_tab1 (c1 set('a', 'b')) charset utf8;
NOTICE:  CREATE TABLE will create implicit set "test_temp_tab1_c1_set" for column "test_temp_tab1.c1"
insert into test_temp_tab1 values('a  ');
insert into test_temp_tab1 values('A  ');
create global temp table test_temp_tab2 (c1 set('a', 'b')) charset utf8 collate utf8_bin;
NOTICE:  CREATE TABLE will create implicit set "test_temp_tab2_c1_set" for column "test_temp_tab2.c1"
insert into test_temp_tab2 values('a  ');
insert into test_temp_tab2 values('A  '); --fail
ERROR:  invalid input value for set test_temp_tab2_c1_set: 'A  '
LINE 1: insert into test_temp_tab2 values('A  ');
                                          ^
CONTEXT:  referenced column: c1
drop table test_temp_tab1;
drop table test_temp_tab2;
-- test ustore
create table test_ustore1(
  c1 set('a', 'b', 'c', 'd'),
  c2 set('a', 'b','A', 'B') collate 'gbk_bin'
) charset utf8 with (STORAGE_TYPE = ustore);
NOTICE:  CREATE TABLE will create implicit set "test_ustore1_c1_set" for column "test_ustore1.c1"
NOTICE:  CREATE TABLE will create implicit set "test_ustore1_c2_set" for column "test_ustore1.c2"
select pg_get_tabledef('test_ustore1');
                                 pg_get_tabledef                                 
---------------------------------------------------------------------------------
 SET search_path = public;                                                      +
 CREATE TABLE test_ustore1 (                                                    +
     c1 SET('a', 'b', 'c', 'd') CHARACTER SET "UTF8" COLLATE utf8mb4_general_ci,+
     c2 SET('a', 'b', 'A', 'B') CHARACTER SET "GBK" COLLATE gbk_bin             +
 )                                                                              +
 CHARACTER SET = "UTF8" COLLATE = "utf8mb4_general_ci"                          +
 WITH (orientation=row, storage_type=ustore, compression=no);
(1 row)

insert into test_ustore1 values('a  ', 'a  ');
insert into test_ustore1 values('A  ', 'A  ');
select c2 from test_ustore1 where c2 = 'a';
 c2 
----
 a
(1 row)

select c2 from test_ustore1 where c2 = 'a' collate 'utf8_general_ci';
 c2 
----
 a
 A
(2 rows)

select c2 from test_ustore1 where c2 = c1;
 c2 
----
 a
 A
(2 rows)

drop table test_ustore1;
-- test cstore(not supported)
create table test_cstore1(c1 set('a', 'b', 'c', 'd') collate 'utf8_bin') with (ORIENTATION = column);
NOTICE:  CREATE TABLE will create implicit set "test_cstore1_c1_set" for column "test_cstore1.c1"
ERROR:  type "test_cstore1_c1_set" is not supported in column store
-- test check constraint with collate
create table test_check1(a set('a', 'b', 'c') check(a >= 'b'))charset utf8;
NOTICE:  CREATE TABLE will create implicit set "test_check1_a_set" for column "test_check1.a"
insert into test_check1 values('a');
ERROR:  new row for relation "test_check1" violates check constraint "test_check1_a_check"
DETAIL:  N/A
insert into test_check1 values('B  ');
insert into test_check1 values('C');
insert into test_check1 values('c');
drop table test_check1;
